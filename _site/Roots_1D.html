<!DOCTYPE html>
<html>


  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Root Finding in One Dimension</title>
    <!-- <meta name="description" content="Blog Introduction to Computational Condensed Matter Physics"> -->
    <link rel="stylesheet" href="/M4/css/main.css">
    <link rel="canonical" href="http://localhost:4000/M4/Roots_1D.html">
    <meta name="google-site-verification" content="FLWeXTRDBUYGSJXcdiUyqbwExBElCj76l3EdhtLL-wI" />
          <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [ ['$','$'], ['\(', '\)'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true,
    }
  });
</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


    <meta property="og:title" content="Root Finding in One Dimension" />
    <meta property="og:image" content="https://albi3ro.github.io/M4/Images/Roots/nrmethod.png" />
    <meta property="twitter:card" content="summary" />
    <meta property="twitter:site" content="@PyrochloreLee" />
    <meta property="twitter:title" content="Root Finding in One Dimension" />
    <meta property="twitter:image" content="https://albi3ro.github.io/M4/Images/Roots/nrmethod.png" />
    <meta property="twitter:description" content="Finding the roots of a function in one dimension via tha Midpoint, Newton-Raphson, Secant, and Regula-Falsi Methods." />

    <link rel="apple-touch-icon" sizes="180x180" href="/M4/Images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/M4/Images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/M4/Images/favicons/favicon-16x16.png">
    <link rel="manifest" href="/M4/Images/favicons/manifest.json">
    <link rel="mask-icon" href="/M4/Images/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="theme-color" content="#000000">

</head>


  <body>


    <header class="site-header">

  <div>

    <a class="site-title" href="/M4/">Metals, Magnets, and Miscellaneous Materials</a>

    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top" style="float: right">
    <input type="hidden" name="cmd" value="_donations">
    <input type="hidden" name="business" value="chrissie.c.l@gmail.com">
    <input type="hidden" name="lc" value="US">
    <input type="hidden" name="item_name" value="M4">
    <input type="hidden" name="no_note" value="0">
    <input type="hidden" name="currency_code" value="USD">
    <input type="hidden" name="bn" value="PP-DonationsBF:btn_donate_SM.gif:NonHostedGuest">
    <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
    <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
    </form>



  </div>

</header>




    <div class="page-content">
        <div class="downloadzp"><a href="https://github.com/albi3ro/M4/archive/master.zip" class="sidebar">Zip!</a></div>

        <div class="clonelink"><a href="https://github.com/albi3ro/M4.git" class="sidebar">Clone!</a></div>

        <div class="pdfslink"><a href="/M4/pdfs" class="sidebar">PDFs</a></div>

        <div class="juliadocs"><a href="https://docs.julialang.org/" class="sidebar">Docs</a></div>

        <div class="juliahelp"><a href="/M4/jupyterjulia" class="sidebar">Interact</a></div>

        <div class="about"><a href="/M4/about" class="sidebar">About</a></div>

      <div class="wrapper">
        <div class="post">
<meta name="description" content="Finding the roots of a function in one dimension via tha Midpoint, Newton-Raphson, Secant, and Regula-Falsi Methods." />
<meta name="keywords" content="Roots" />
<meta name="author" content="Christina C. Lee" />

  <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

  <header class="post-header">
    <h1 class="post-title" itemprop="name">Root Finding in One Dimension</h1>
    <p class="post-meta">Author: Christina C. Lee &nbsp;&nbsp;&nbsp;&nbsp;
      Category: <a href="/M4/categories">
        Numerics</a> &nbsp;  &nbsp; &nbsp; &nbsp;
        Tags:
      
      <a href="/M4/tags#Roots">Roots</a>&nbsp; 
        </p>
  </header>

  <article class="post-content">

    <p>When does a value reach zero?</p>

<p>When will I have spent all my money?
When will Siberian tigers go extinct? Will they?
At what altitude do I need to place a satellite to ensure it remains stationary with respect to the surface of the Earth? 
Where will this cannonball hit the ground?</p>

<p>Solving these types of problems involves the application of <i>Root Finding</i>, or determining when a value crosses zero.</p>

<hr />

<p>Paradoxically, you should always generally know what your answer is before you use before a Root Finding Algorithm.</p>

<p>I’ll explain what I mean.</p>

<p>These methods are suitable for refining the precise value of a zero once you already have a general idea of the behavior of the function.  Otherwise, you might fall into one of the algorithm’s pitfalls and remain blissfully ignorant of how completely wrong you are.  These methods are <b>NOT</b> golden hammers you can go around swinging at things willy-nilly and expecting wonderful answers to just appear.</p>

<p>Number one solution to avoid root-finding catastrophe?
<b>GRAPH THE FUNCTION</b></p>

<p>Number two?  Also, <b>GRAPH THE FUNCTION</b>.</p>

<p>Mostly, figure out as much behavior beforehand as you can.</p>
<ul>
  <li>What are its limits?</li>
  <li>Does it diverge anywhere?</li>
  <li>Is it smooth and well behaved?</li>
  <li>Do we have a derivative?</li>
  <li>Could we have an even multiplicity situation?</li>
</ul>

<h3 id="multiplicity">Multiplicity</h3>

<p>The function $x^2-1$ intersects the x-axis twice.  As we move it up, at the function $x^2$ only intersects once, but we consider it a <i>zero of multiplicity two</i>. We count the zero of $x^2$ as an ‘‘axis-crossing going down’’ and an ‘‘axis-crossing going up’’ both at the same time.</p>

<p>If we have multiplicity three like $x^3$ at zero, the function goes up, then down, then back up again.  Overall, $x^3$ heads straight across the x-axis.</p>

<p>Again at another even multiplicity, $x^4$ with multiplicity 4, the function goes down, up, down, then up.  Overall, $x^4$ hits the axis but never crosses it.</p>

<p>When we have zeros of even multiplicity, we will <b>hit the axis</b> $f(x)=0$, but <b>never change signs</b>.</p>

<p>This lack of changing signs is the significant bit, as it makes confirming the existence of a zero somewhat tricky and eliminates certain methods from our arsenal.</p>

<h2 id="methods">Methods</h2>

<p>In this post, we cover:</p>

<ul>
  <li>Midpoint</li>
  <li>Newton-Raphson</li>
  <li>Secant</li>
  <li>Regula-Falsi</li>
</ul>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">using</span> <span class="n">ForwardDiff</span>
<span class="n">using</span> <span class="n">Statistics</span>
<span class="n">using</span> <span class="n">SpecialFunctions</span>
<span class="n">using</span> <span class="n">Plots</span>
<span class="n">gr</span><span class="x">()</span>
</code></pre>
</div>

<h2 id="test-functions">Test Functions</h2>

<ul>
  <li>$f(x)= 2 \cos(x) - x + x^2/10$</li>
  <li>$x^2$</li>
  <li>$1/x$</li>
  <li>$\text{loop}(x)=x^3 - 2x +2 $</li>
  <li>$x^{1/3}$</li>
</ul>

<p>The first function is a standard run-of-the-mill transcendental function.  Transcendental: a function that involves non-polynomial terms.  The non-polynomial terms will usually prevent the determination of zeros by algebraic means.</p>

<p>The other functions will pose interesting challenges for one or more of the methods.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">f</span><span class="x">(</span><span class="n">x</span><span class="x">)</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="x">(</span><span class="n">x</span><span class="x">)</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">10</span>
<span class="n">x2</span><span class="x">(</span><span class="n">x</span><span class="x">)</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="n">recip</span><span class="x">(</span><span class="n">x</span><span class="x">)</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span>
<span class="n">loop</span><span class="x">(</span><span class="n">x</span><span class="x">)</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span>
<span class="n">cubert</span><span class="x">(</span><span class="n">x</span><span class="x">)</span><span class="o">=</span><span class="n">cbrt</span><span class="x">(</span><span class="n">x</span><span class="x">)</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">xh</span><span class="o">=</span><span class="n">collect</span><span class="x">(</span><span class="mf">0.01</span><span class="x">:</span><span class="mf">0.01</span><span class="x">:</span><span class="mi">5</span><span class="x">)</span>

<span class="n">plot</span><span class="x">(</span><span class="n">f</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Transcendental Function"</span>
    <span class="x">,</span><span class="n">ylims</span><span class="o">=</span><span class="x">(</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="mi">1</span><span class="x">),</span><span class="n">legend</span><span class="o">=</span><span class="x">:</span><span class="n">topleft</span><span class="x">)</span>
<span class="n">plot!</span><span class="x">(</span><span class="n">x2</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Multiplicity 2"</span><span class="x">)</span>
<span class="n">plot!</span><span class="x">(</span><span class="n">vcat</span><span class="x">(</span><span class="n">xh</span><span class="x">,</span><span class="o">-</span><span class="n">xh</span><span class="x">),</span><span class="n">vcat</span><span class="x">(</span><span class="n">recip</span><span class="o">.</span><span class="x">(</span><span class="n">xh</span><span class="x">),</span><span class="n">recip</span><span class="o">.</span><span class="x">(</span><span class="o">-</span><span class="n">xh</span><span class="x">)),</span><span class="n">label</span><span class="o">=</span><span class="s">"Divergence"</span><span class="x">)</span>
<span class="n">hline!</span><span class="x">([</span><span class="mi">0</span><span class="x">],</span><span class="n">label</span><span class="o">=</span><span class="s">"Zero"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Roots/output_4_0.svg" alt="Functions" />
    
    
        <p class="image-caption"></p>
    
</div>

<h2 id="interchangeability">Interchangeability</h2>

<p>The first time I implement an algorithm, I usually don’t wrap it up into a function at all. Once I do wrap it into a function, the function, I take just the inputs required for what I wrapped up in some random order and send back some large chunk of data.   There is nothing wrong with just slapping things together till they work, but like in this post here when I have functions that achieve the same thing, a little editing can make things better.</p>

<p>Some of the methods here require brackets, some points, some derivative functions, or just some other combination of all these.  With this variability, how do we standardize the inputs? Fiddling till I find something that works.  I wrapped inputs up into values that get interated and values that don’t.</p>

<p>When all the inputs and outputs are standardized for our methods, I can then plug them into another apparatus like this next function, the ‘Zero_Iterator’.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="k">function</span><span class="nf"> Zero_Iterator</span><span class="x">(</span><span class="n">f</span><span class="o">::</span><span class="n">Function</span><span class="x">,</span><span class="n">Method</span><span class="o">::</span><span class="n">Function</span><span class="x">,</span>
        <span class="n">iterated_values0</span><span class="o">::</span><span class="n">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">},</span><span class="n">params</span><span class="x">,</span><span class="n">N</span><span class="x">)</span>
    
    <span class="n">n_values</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="kt">Float64</span><span class="x">,</span><span class="n">length</span><span class="x">(</span><span class="n">iterated_values0</span><span class="x">),</span><span class="n">N</span><span class="x">)</span>
    <span class="n">n_values</span><span class="x">[:,</span><span class="mi">1</span><span class="x">]</span><span class="o">=</span><span class="n">iterated_values0</span><span class="x">;</span>
    
    <span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">2</span><span class="x">:</span><span class="n">N</span>
        <span class="n">n_values</span><span class="x">[:,</span><span class="n">ii</span><span class="x">]</span> <span class="o">=</span> <span class="n">Method</span><span class="x">(</span><span class="n">f</span><span class="x">,</span><span class="n">n_values</span><span class="x">[:,(</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">)],</span><span class="n">params</span><span class="x">)</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="n">n_values</span>
<span class="k">end</span>
</code></pre>
</div>

<h2 id="midpoint-method">Midpoint Method</h2>

<p>In the midpoint method, we try localizing the root into successively smaller and smaller intervals by breaking the bracket in half each time.  We determine which half the zero is located in by determining <i>where the function changes sign</i>.</p>

<p>As long as the function changes sign and we have bracketed a legitimate zero, we are good to go. This method will steadily and surely hone in on a zero for us.</p>

<p>BUT, if the function doesn’t change sign, $x^2$, or if we haven’t bracketed a legitimate zero, $1/x$ divergence, the method will steadily and surely lead us to absolutely nothing.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="k">function</span><span class="nf"> Midpoint</span><span class="x">(</span><span class="n">f</span><span class="o">::</span><span class="n">Function</span><span class="x">,</span><span class="n">endpoints</span><span class="o">::</span><span class="n">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">},</span><span class="n">params</span><span class="x">)</span>
    <span class="k">if</span> <span class="n">f</span><span class="x">(</span><span class="n">endpoints</span><span class="x">[</span><span class="mi">1</span><span class="x">])</span><span class="o">*</span><span class="n">f</span><span class="x">(</span><span class="n">endpoints</span><span class="x">[</span><span class="mi">2</span><span class="x">])</span><span class="o">&gt;</span><span class="mi">0</span>
        <span class="n">println</span><span class="x">(</span><span class="s">"Endpoints must bracket a zero.  Please pick better endpoints."</span><span class="x">)</span>
        <span class="nb">error</span><span class="x">()</span>
    <span class="k">end</span>
    <span class="n">c</span><span class="o">=</span><span class="n">mean</span><span class="x">(</span><span class="n">endpoints</span><span class="x">)</span>
    <span class="k">if</span> <span class="n">f</span><span class="x">(</span><span class="n">endpoints</span><span class="x">[</span><span class="mi">1</span><span class="x">])</span><span class="o">*</span><span class="n">f</span><span class="x">(</span><span class="n">c</span><span class="x">)</span><span class="o">&lt;</span><span class="mi">0</span>
        <span class="k">return</span> <span class="x">[</span> <span class="n">endpoints</span><span class="x">[</span><span class="mi">1</span><span class="x">],</span><span class="n">c</span><span class="x">]</span>
    <span class="k">elseif</span> <span class="n">f</span><span class="x">(</span><span class="n">c</span><span class="x">)</span><span class="o">*</span><span class="n">f</span><span class="x">(</span><span class="n">endpoints</span><span class="x">[</span><span class="mi">2</span><span class="x">])</span><span class="o">&lt;</span><span class="mi">0</span>
        <span class="k">return</span> <span class="x">[</span><span class="n">c</span><span class="x">,</span> <span class="n">endpoints</span><span class="x">[</span><span class="mi">2</span><span class="x">]]</span>
    <span class="k">elseif</span> <span class="n">f</span><span class="x">(</span><span class="n">c</span><span class="x">)</span> <span class="o">==</span><span class="mi">0</span> 
        <span class="n">print</span><span class="x">(</span><span class="s">"midpoint is zero"</span><span class="x">)</span>
        <span class="k">return</span> <span class="x">[</span><span class="n">c</span><span class="x">,</span><span class="n">c</span><span class="x">]</span>
    <span class="k">else</span>   
        <span class="n">println</span><span class="x">(</span><span class="s">"Mid point doesn't bracket a zero... somethign weird..."</span><span class="x">)</span>
        <span class="n">print</span><span class="x">(</span><span class="n">c</span><span class="x">,</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="x">,</span><span class="n">f</span><span class="x">(</span><span class="n">c</span><span class="x">))</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">endpoints_M_f</span><span class="o">=</span><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">f</span><span class="x">,</span><span class="n">Midpoint</span><span class="x">,[</span><span class="o">-</span><span class="mf">1.0</span><span class="x">,</span><span class="mf">2.0</span><span class="x">],[</span><span class="s">"null"</span><span class="x">],</span><span class="mi">10</span><span class="x">)</span>
<span class="n">dx_M_f</span><span class="o">=</span><span class="n">endpoints_M_f</span><span class="x">[</span><span class="mi">2</span><span class="x">,:]</span><span class="o">-</span><span class="n">endpoints_M_f</span><span class="x">[</span><span class="mi">1</span><span class="x">,:]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>10-element Array{Float64,1}:
 3.0        
 1.5        
 0.75       
 0.375      
 0.1875     
 0.09375    
 0.046875   
 0.0234375  
 0.01171875 
 0.005859375
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">endpoints_M_recip</span><span class="o">=</span><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">recip</span><span class="x">,</span><span class="n">Midpoint</span><span class="x">,[</span><span class="o">-</span><span class="mf">1.4</span><span class="x">,</span><span class="mf">1.0</span><span class="x">],[</span><span class="s">"null"</span><span class="x">],</span><span class="mi">10</span><span class="x">)</span>
<span class="n">dx_M_recip</span><span class="o">=</span><span class="n">endpoints_M_recip</span><span class="x">[</span><span class="mi">2</span><span class="x">,:]</span><span class="o">-</span><span class="n">endpoints_M_recip</span><span class="x">[</span><span class="mi">1</span><span class="x">,:]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>10-element Array{Float64,1}:
 2.4      
 1.2      
 0.6      
 0.3      
 0.15     
 0.075    
 0.0375   
 0.01875  
 0.009375 
 0.0046875
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">transpose</span><span class="x">(</span><span class="n">endpoints_M_recip</span><span class="x">),</span><span class="n">label</span><span class="o">=</span><span class="x">[</span><span class="s">"Right Boundary"</span><span class="x">,</span><span class="s">"Left Boundary"</span><span class="x">])</span>
<span class="n">plot!</span><span class="x">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Divergence of 1/x is a zero?"</span>
    <span class="x">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s">"steps"</span><span class="x">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s">"Boundary Position"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Roots/output_11_0.svg" alt="Midpoint Method on $1/x$" />
    
    
        <p class="image-caption"></p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">endpoints_M_zeta</span><span class="o">=</span><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">zeta</span><span class="x">,</span><span class="n">Midpoint</span><span class="x">,[</span><span class="o">-</span><span class="mf">17.1</span><span class="x">,</span><span class="o">-</span><span class="mf">15.</span><span class="x">],[</span><span class="s">"null"</span><span class="x">],</span><span class="mi">10</span><span class="x">)</span>
<span class="n">dx_M_zeta</span><span class="o">=</span><span class="n">endpoints_M_zeta</span><span class="x">[</span><span class="mi">2</span><span class="x">,:]</span><span class="o">-</span><span class="n">endpoints_M_zeta</span><span class="x">[</span><span class="mi">1</span><span class="x">,:]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>10-element Array{Float64,1}:
 2.1000000000000014   
 1.0500000000000007   
 0.5250000000000004   
 0.2624999999999993   
 0.13124999999999964  
 0.06562500000000071  
 0.03281249999999858  
 0.01640624999999929  
 0.008203124999999645 
 0.0041015625000007105
</code></pre>
</div>

<h2 id="newton-raphson-method">Newton-Raphson Method</h2>

<p>The Newton-Raphson Method uses the derivative at a point to extrapolate to where a zero would occur if the function was sufficiently well approximated by the derivative.  Even curvature and higher expansion terms do largely influence the function, we at least get going in the right direction, so the next iteration will be better.  We’ll see that with $x^2$ near $0$.</p>

<p>When the function is well approximated by its derivative, this method works extremely well.</p>

<p>Con: We need a derivative. What if we want to find the zero of experimental data? Or something really convoluted like the Riemann Zeta function?</p>

<p>How does it work?  Let’s take a look at this picture, that we will calculate later,
<!-- _includes/image.html --></p>
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Roots/nrmethod.png" alt="Visual Newton-Raphson Method" />
    
    
        <p class="image-caption"></p>
    
</div>

<p>We follow the derivative to zero, then use that intercept as our next approximation.  Taking the new slope, we again follow the line to zero.  We get a new intercept and repeat the process.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="k">function</span><span class="nf"> Newtons</span><span class="x">(</span><span class="n">f</span><span class="o">::</span><span class="n">Function</span><span class="x">,</span><span class="n">x</span><span class="o">::</span><span class="n">Array</span><span class="x">,</span><span class="n">fp</span><span class="o">::</span><span class="n">Array</span><span class="x">)</span>
    <span class="k">return</span> <span class="x">[</span> <span class="n">x</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">-</span> <span class="n">f</span><span class="x">(</span><span class="n">x</span><span class="x">[</span><span class="mi">1</span><span class="x">])</span><span class="o">/</span><span class="n">fp</span><span class="x">[</span><span class="mi">1</span><span class="x">](</span><span class="n">x</span><span class="x">[</span><span class="mi">1</span><span class="x">])</span> <span class="x">]</span>
<span class="k">end</span>
</code></pre>
</div>

<p>We can analytically calculating derivatives using ‘ForwardDiff.jl’.  The syntax is</p>

<div class="highlighter-rouge"><pre class="highlight"><code>f_prep(x::Vector)=f(x[1])
f_prep2=(x-&gt;ForwardDiff.gradient(f_prep,x))
fp(x)=f_prep2(x .*[1.])[1]
</code></pre>
</div>

<p>For the relevant functions, I’m just going to type out the derivatives, but if you don’t want to take the derivatives yourself, you can use those lines of code.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">fp</span><span class="x">(</span><span class="n">x</span><span class="x">)</span><span class="o">=-</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="x">(</span><span class="n">x</span><span class="x">)</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span>
<span class="n">dx2</span><span class="x">(</span><span class="n">x</span><span class="x">)</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span>
<span class="n">drecip</span><span class="x">(</span><span class="n">x</span><span class="x">)</span><span class="o">=-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="n">dloop</span><span class="x">(</span><span class="n">x</span><span class="x">)</span><span class="o">=</span><span class="mi">3</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span>
<span class="n">dcubert</span><span class="x">(</span><span class="n">x</span><span class="x">)</span><span class="o">=</span><span class="x">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="x">)</span><span class="o">*</span><span class="n">cbrt</span><span class="x">(</span><span class="n">x</span><span class="o">^</span><span class="x">(</span><span class="o">-</span><span class="mi">2</span><span class="x">))</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">x_NR_f</span><span class="o">=</span><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">f</span><span class="x">,</span><span class="n">Newtons</span><span class="x">,[</span><span class="mf">2.0</span><span class="x">],[</span><span class="n">fp</span><span class="x">],</span><span class="mi">10</span><span class="x">)[</span><span class="mi">1</span><span class="x">,:]</span>
<span class="n">dx_NR_f</span><span class="o">=</span><span class="n">x_NR_f</span><span class="o">.-</span><span class="n">x_NR_f</span><span class="x">[</span><span class="k">end</span><span class="x">]</span>

<span class="n">println</span><span class="x">(</span><span class="s">"ii </span><span class="se">\t</span><span class="s"> Guess </span><span class="se">\t\t\t</span><span class="s"> dx"</span><span class="x">)</span>
<span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">length</span><span class="x">(</span><span class="n">x_NR_f</span><span class="x">)</span>
    <span class="n">println</span><span class="x">(</span><span class="n">ii</span><span class="x">,</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="x">,</span><span class="n">x_NR_f</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="x">,</span><span class="n">dx_NR_f</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>ii 	 Guess 			     dx
1	2.0	                0.9281352793610165
2	0.9943360420939289	-0.07752867854505463
3	1.0728910967625935	0.0010263761236100066
4	1.0718648772052064	1.5656622287529842e-7
5	1.0718647206389873	3.774758283725532e-15
6	1.0718647206389835	0.0
7	1.0718647206389835	0.0
8	1.0718647206389835	0.0
9	1.0718647206389835	0.0
10	1.0718647206389835	0.0
</code></pre>
</div>

<p>Hmmm…. little faster wouldn’t you say? Didn’t even have to run that many iterations to reach Float64 accuracy. But let’s run it on a multiplicity two zero and see if that efficiency stays.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">x_NR_x2</span><span class="o">=</span><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">x2</span><span class="x">,</span><span class="n">Newtons</span><span class="x">,[</span><span class="mf">1.0</span><span class="x">],[</span><span class="n">dx2</span><span class="x">],</span><span class="mi">10</span><span class="x">)[</span><span class="mi">1</span><span class="x">,:]</span>
<span class="n">dx_NR_x2</span><span class="o">=</span><span class="n">x_NR_x2</span><span class="o">.-</span><span class="n">x_NR_x2</span><span class="x">[</span><span class="k">end</span><span class="x">]</span>

<span class="n">println</span><span class="x">(</span><span class="s">"ii </span><span class="se">\t</span><span class="s"> Guess </span><span class="se">\t\t</span><span class="s"> dx"</span><span class="x">)</span>
<span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">length</span><span class="x">(</span><span class="n">x_NR_x2</span><span class="x">)</span>
    <span class="n">println</span><span class="x">(</span><span class="n">ii</span><span class="x">,</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="x">,</span><span class="n">x_NR_x2</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="x">,</span><span class="n">dx_NR_x2</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>ii 	 Guess 		 dx
1	1.0     	0.998046875
2	0.5     	0.498046875
3	0.25    	0.248046875
4	0.125	    0.123046875
5	0.0625  	0.060546875
6	0.03125	    0.029296875
7	0.015625	0.013671875
8	0.0078125	0.005859375
9	0.00390625	0.001953125
10	0.001953125	0.0
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">x2</span><span class="x">,</span>
    <span class="n">xlims</span><span class="o">=</span><span class="x">(</span><span class="o">-.</span><span class="mi">5</span><span class="x">,</span><span class="mf">1.5</span><span class="x">),</span><span class="n">ylims</span><span class="o">=</span><span class="x">(</span><span class="o">-.</span><span class="mi">5</span><span class="x">,</span><span class="mi">2</span><span class="x">),</span><span class="n">legend</span><span class="o">=</span><span class="n">false</span><span class="x">)</span>
<span class="n">hline!</span><span class="x">([</span><span class="mi">0</span><span class="x">])</span>

<span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="mi">5</span>
    <span class="n">plot!</span><span class="x">(</span><span class="n">x_NR_x2</span><span class="x">[(</span><span class="mi">0</span><span class="x">:</span><span class="mi">1</span><span class="x">)</span><span class="o">.+</span><span class="n">ii</span><span class="x">],</span>
        <span class="n">x2</span><span class="x">(</span><span class="n">x_NR_x2</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span><span class="o">.+</span><span class="n">dx2</span><span class="x">(</span><span class="n">x_NR_x2</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span><span class="o">.*</span><span class="x">(</span><span class="n">x_NR_x2</span><span class="x">[(</span><span class="mi">0</span><span class="x">:</span><span class="mi">1</span><span class="x">)</span><span class="o">.+</span><span class="n">ii</span><span class="x">]</span>
            <span class="o">.-</span><span class="n">x_NR_x2</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
             <span class="x">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="x">,</span><span class="n">color</span><span class="o">=</span><span class="n">cgrad</span><span class="x">(:</span><span class="n">inferno</span><span class="x">)[</span><span class="n">ii</span><span class="o">/</span><span class="mi">5</span><span class="x">])</span>
    <span class="n">plot!</span><span class="x">([</span><span class="n">x_NR_x2</span><span class="x">[</span><span class="mi">1</span><span class="o">+</span><span class="n">ii</span><span class="x">],</span><span class="n">x_NR_x2</span><span class="x">[</span><span class="mi">1</span><span class="o">+</span><span class="n">ii</span><span class="x">]],[</span><span class="mi">0</span><span class="x">,</span><span class="n">x2</span><span class="x">(</span><span class="n">x_NR_x2</span><span class="x">[</span><span class="mi">1</span><span class="o">+</span><span class="n">ii</span><span class="x">])]</span>
             <span class="x">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="x">,</span><span class="n">color</span><span class="o">=</span><span class="n">cgrad</span><span class="x">(:</span><span class="n">inferno</span><span class="x">)[</span><span class="n">ii</span><span class="o">/</span><span class="mi">5</span><span class="x">])</span>
<span class="k">end</span>
<span class="n">plot!</span><span class="x">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Visual Newton-Raphson"</span><span class="x">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s">"x"</span><span class="x">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s">"y"</span><span class="x">)</span>

</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Roots/output_20_0.svg" alt="Visual Newton Raphson" />
    
    
        <p class="image-caption"></p>
    
</div>

<p>Yeah… a bit slower.  But at least it will work, unlike the Midpoint algorithm.</p>

<p>And if we run it on $1/x$, instead of identifying the divergence as a zero, this method runs off to infinity, which technically is a zero.  By using this method and looking at how it behaves over the iterations, or by looking at a graph, we can determine that $\pm \infty$ are zeros of this next function.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">x_NR_recip</span><span class="o">=</span><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">recip</span><span class="x">,</span><span class="n">Newtons</span><span class="x">,[</span><span class="mf">2.0</span><span class="x">],[</span><span class="n">drecip</span><span class="x">],</span><span class="mi">10</span><span class="x">)[</span><span class="mi">1</span><span class="x">,:]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>10-element Array{Float64,1}:
    2.0
    4.0
    8.0
   16.0
   32.0
   64.0
  128.0
  256.0
  512.0
 1024.0
</code></pre>
</div>

<h3 id="cycles">Cycles</h3>

<p>Remember how I said you should generally know how your functions behaves before applying the algorithm?  In this next situation, the algorithm can get stuck in a loop just going back and forth between a couple of values, never actually approaching a zero.</p>

<p>Even more problematically, these cycles tend to be stable, as the evaluation at the second starting point shows us.</p>

<p>More sophisticated methods than the one’s I’m showing here and check to see if NR is returning less than linear convergence, and default to the Midpoint method in those circumstances.  This way, you can achieve the NR speedup, but keep the Midpoint method’s robustness.</p>

<p>These are somehow related to <a href="https://en.wikipedia.org/wiki/Newton_fractal">Newton Fractals</a> and some other mathematics I don’t yet understand. Feel free to look them up if you feel so inclined.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="c"># a loop where the iteration gets stuck between two points</span>
<span class="n">x_NR_loop</span><span class="o">=</span><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">loop</span><span class="x">,</span><span class="n">Newtons</span><span class="x">,[</span><span class="mf">1.0</span><span class="x">],[</span><span class="n">dloop</span><span class="x">],</span><span class="mi">10</span><span class="x">)[</span><span class="mi">1</span><span class="x">,:]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>10-element Array{Float64,1}:
 1.0
 0.0
 1.0
 0.0
 1.0
 0.0
 1.0
 0.0
 1.0
 0.0
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="c"># perturb the starting point, and we still don't really go anywhere...</span>
<span class="n">x_NR_loop2</span><span class="o">=</span><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">loop</span><span class="x">,</span><span class="n">Newtons</span><span class="x">,[</span><span class="mf">1.05</span><span class="x">],[</span><span class="n">dloop</span><span class="x">],</span><span class="mi">30</span><span class="x">)[</span><span class="mi">1</span><span class="x">,:]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>30-element Array{Float64,1}:
 1.05               
 0.2411089866156788 
 1.080175088368354  
 0.34702226735454855
 1.1694568340618148 
 0.5700574216796792 
 1.5895974204378045 
 1.0811390298381143 
 0.35006578755042594
 1.1726576780806912 
 0.576417062242596  
 1.6117570649270276 
 1.1002257790810774 
 ⋮                  
 1.1617591990955374 
 0.554410475712811  
 1.539289841744783  
 1.036448513259264  
 0.1854610569984695 
 1.0476743181195445 
 0.23196528385652648
 1.074220771179821  
 0.3277999978210737 
 1.1501586826356798 
 0.5298242289692244 
 1.470422869543373  
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">xloop</span><span class="o">=</span><span class="n">collect</span><span class="x">(</span><span class="o">-.</span><span class="mi">5</span><span class="x">:</span><span class="o">.</span><span class="mi">01</span><span class="x">:</span><span class="mi">3</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">xloop</span><span class="x">,</span><span class="n">loop</span><span class="o">.</span><span class="x">(</span><span class="n">xloop</span><span class="x">),</span>
    <span class="n">xlims</span><span class="o">=</span><span class="x">(</span><span class="o">-.</span><span class="mi">5</span><span class="x">,</span><span class="mi">3</span><span class="x">),</span><span class="n">ylims</span><span class="o">=</span><span class="x">(</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="mi">5</span><span class="x">),</span><span class="n">legend</span><span class="o">=</span><span class="n">false</span><span class="x">)</span>
<span class="n">hline!</span><span class="x">([</span><span class="mi">0</span><span class="x">])</span>

<span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="mi">29</span>
    <span class="n">plot!</span><span class="x">(</span><span class="n">x_NR_loop2</span><span class="x">[(</span><span class="mi">0</span><span class="x">:</span><span class="mi">1</span><span class="x">)</span><span class="o">.+</span><span class="n">ii</span><span class="x">],</span>
        <span class="n">loop</span><span class="x">(</span><span class="n">x_NR_loop2</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span><span class="o">.+</span><span class="n">dloop</span><span class="x">(</span><span class="n">x_NR_loop2</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span><span class="o">.*</span><span class="x">(</span><span class="n">x_NR_loop2</span><span class="x">[(</span><span class="mi">0</span><span class="x">:</span><span class="mi">1</span><span class="x">)</span><span class="o">.+</span><span class="n">ii</span><span class="x">]</span>
            <span class="o">.-</span><span class="n">x_NR_loop2</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
        <span class="x">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="x">,</span><span class="n">color</span><span class="o">=</span><span class="n">cgrad</span><span class="x">(:</span><span class="n">inferno</span><span class="x">)[</span><span class="n">ii</span><span class="o">/</span><span class="mi">30</span><span class="x">])</span>
    <span class="n">plot!</span><span class="x">([</span><span class="n">x_NR_loop2</span><span class="x">[</span><span class="mi">1</span><span class="o">+</span><span class="n">ii</span><span class="x">],</span><span class="n">x_NR_loop2</span><span class="x">[</span><span class="mi">1</span><span class="o">+</span><span class="n">ii</span><span class="x">]],[</span><span class="mi">0</span><span class="x">,</span><span class="n">loop</span><span class="x">(</span><span class="n">x_NR_loop2</span><span class="x">[</span><span class="mi">1</span><span class="o">+</span><span class="n">ii</span><span class="x">])]</span>
        <span class="x">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="x">,</span><span class="n">color</span><span class="o">=</span><span class="n">cgrad</span><span class="x">(:</span><span class="n">inferno</span><span class="x">)[</span><span class="n">ii</span><span class="o">/</span><span class="mi">30</span><span class="x">])</span>
<span class="k">end</span>


<span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="mi">9</span>
    <span class="n">plot!</span><span class="x">(</span><span class="n">x_NR_loop</span><span class="x">[(</span><span class="mi">0</span><span class="x">:</span><span class="mi">1</span><span class="x">)</span><span class="o">.+</span><span class="n">ii</span><span class="x">],</span>
        <span class="n">loop</span><span class="x">(</span><span class="n">x_NR_loop</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span><span class="o">.+</span><span class="n">dloop</span><span class="x">(</span><span class="n">x_NR_loop</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span><span class="o">.*</span><span class="x">(</span><span class="n">x_NR_loop</span><span class="x">[(</span><span class="mi">0</span><span class="x">:</span><span class="mi">1</span><span class="x">)</span><span class="o">.+</span><span class="n">ii</span><span class="x">]</span>
            <span class="o">.-</span><span class="n">x_NR_loop</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
        <span class="x">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="x">,</span><span class="n">color</span><span class="o">=</span><span class="x">:</span><span class="n">black</span><span class="x">)</span>
    <span class="n">plot!</span><span class="x">([</span><span class="n">x_NR_loop</span><span class="x">[</span><span class="mi">1</span><span class="o">+</span><span class="n">ii</span><span class="x">],</span><span class="n">x_NR_loop</span><span class="x">[</span><span class="mi">1</span><span class="o">+</span><span class="n">ii</span><span class="x">]],[</span><span class="mi">0</span><span class="x">,</span><span class="n">loop</span><span class="x">(</span><span class="n">x_NR_loop</span><span class="x">[</span><span class="mi">1</span><span class="o">+</span><span class="n">ii</span><span class="x">])]</span>
        <span class="x">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="x">,</span><span class="n">color</span><span class="o">=</span><span class="x">:</span><span class="n">black</span><span class="x">)</span>
<span class="k">end</span>

<span class="n">plot!</span><span class="x">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Newton-Raphson Cycle"</span><span class="x">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s">"x"</span><span class="x">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s">"y"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Roots/output_26_0.svg" alt="Newton-Raphson Cycle" />
    
    
        <p class="image-caption"></p>
    
</div>

<p><img src="output_26_0.svg" alt="svg" /></p>

<p>Here we can see in <b>black</b> the stationary cycle.  Colored by iteration, we can see the perturbed attempt.While is does move over a little to the right once, the path moves right back over to it’s attractive stationary region.  No amount of iterations will get us any closer to a zero.</p>

<h2 id="runaway-iteration">Runaway Iteration</h2>

<p>We can all agree that $\sqrt[3]{0}=0$, right?</p>

<p>At least all of us except for the Newton-Raphson method.</p>

<p>The situation where the <i>derivative is undefined at the root</i> is another time when the algorithm fails and steps just run around willy-nilly giving us meaningless nothing.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">x_NR_cubert</span><span class="o">=</span><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">cubert</span><span class="x">,</span><span class="n">Newtons</span><span class="x">,[</span><span class="mf">1.0</span><span class="x">],[</span><span class="n">dcubert</span><span class="x">],</span><span class="mi">10</span><span class="x">)[</span><span class="mi">1</span><span class="x">,:]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>10-element Array{Float64,1}:
    1.0
   -2.0
    4.0
   -8.0
   16.0
  -32.0
   64.0
 -128.0
  256.0
 -512.0
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">x_cubert</span><span class="o">=</span><span class="n">collect</span><span class="x">(</span><span class="o">-</span><span class="mi">30</span><span class="x">:</span><span class="mf">0.01</span><span class="x">:</span><span class="mi">30</span><span class="x">)</span>

<span class="n">plot</span><span class="x">(</span><span class="n">x_cubert</span><span class="x">,</span><span class="n">cubert</span><span class="o">.</span><span class="x">(</span><span class="n">x_cubert</span><span class="x">),</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span>
    <span class="x">,</span><span class="n">xlims</span><span class="o">=</span><span class="x">(</span><span class="o">-</span><span class="mi">30</span><span class="x">,</span><span class="mi">30</span><span class="x">),</span><span class="n">legend</span><span class="o">=</span><span class="n">false</span><span class="x">)</span>
<span class="n">hline!</span><span class="x">([</span><span class="mi">0</span><span class="x">])</span>

<span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="mi">9</span>
    <span class="n">plot!</span><span class="x">(</span><span class="n">x_NR_cubert</span><span class="x">[(</span><span class="mi">0</span><span class="x">:</span><span class="mi">1</span><span class="x">)</span><span class="o">.+</span><span class="n">ii</span><span class="x">],</span>
        <span class="n">cubert</span><span class="x">(</span><span class="n">x_NR_cubert</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span><span class="o">.+</span><span class="n">dcubert</span><span class="x">(</span><span class="n">x_NR_cubert</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span><span class="o">.*</span><span class="x">(</span><span class="n">x_NR_cubert</span><span class="x">[(</span><span class="mi">0</span><span class="x">:</span><span class="mi">1</span><span class="x">)</span><span class="o">.+</span><span class="n">ii</span><span class="x">]</span>
            <span class="o">.-</span><span class="n">x_NR_cubert</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
        <span class="x">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="x">,</span><span class="n">color</span><span class="o">=</span><span class="n">cgrad</span><span class="x">(:</span><span class="n">inferno</span><span class="x">)[</span><span class="n">ii</span><span class="o">/</span><span class="mi">10</span><span class="x">])</span>
    <span class="n">plot!</span><span class="x">([</span><span class="n">x_NR_cubert</span><span class="x">[</span><span class="mi">1</span><span class="o">+</span><span class="n">ii</span><span class="x">],</span><span class="n">x_NR_cubert</span><span class="x">[</span><span class="mi">1</span><span class="o">+</span><span class="n">ii</span><span class="x">]],[</span><span class="mi">0</span><span class="x">,</span><span class="n">cubert</span><span class="x">(</span><span class="n">x_NR_cubert</span><span class="x">[</span><span class="mi">1</span><span class="o">+</span><span class="n">ii</span><span class="x">])]</span>
        <span class="x">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="x">,</span><span class="n">color</span><span class="o">=</span><span class="n">cgrad</span><span class="x">(:</span><span class="n">inferno</span><span class="x">)[</span><span class="n">ii</span><span class="o">/</span><span class="mi">10</span><span class="x">])</span>
<span class="k">end</span>
<span class="n">plot!</span><span class="x">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Runaway Argument"</span><span class="x">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s">"x"</span><span class="x">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s">"y"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Roots/output_30_0.svg" alt="Failure of Newton-Raphson on the Cube Root" />
    
    
        <p class="image-caption"></p>
    
</div>

<h2 id="secant-method">Secant Method</h2>

<p>This method fixes the Newton-Raphson Method’s requirement for a derivative by using two points to calculate an approximate derivative.</p>

<p>If you try to get an accurate derivative by evaluating the function at points close to each other, we are wasting a function evaluation. We might get information on the derivative, but we don’t get any new information on the function, even though we are re-evaluating the function.</p>

<p>We can fix this by spacing apart the points we use to calculate the secant.  After the first two points we use to initialize, the algorithm uses the last two iteration values.  This way we calculate as little new things as possible.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="c"># x[1:2] are last two points</span>
<span class="c"># x[2] more recent and x[1] older</span>
<span class="c"># x[3:4] are f values of last two points</span>
<span class="k">function</span><span class="nf"> Secant</span><span class="x">(</span><span class="n">f</span><span class="o">::</span><span class="n">Function</span><span class="x">,</span><span class="n">x</span><span class="o">::</span><span class="n">Array</span><span class="x">,</span><span class="n">params</span><span class="o">::</span><span class="n">Array</span><span class="x">)</span>
    <span class="n">xnew</span><span class="o">=</span> <span class="n">x</span><span class="x">[</span><span class="mi">2</span><span class="x">]</span> <span class="o">-</span> <span class="n">x</span><span class="x">[</span><span class="mi">4</span><span class="x">]</span><span class="o">*</span><span class="x">(</span><span class="n">x</span><span class="x">[</span><span class="mi">2</span><span class="x">]</span><span class="o">-</span><span class="n">x</span><span class="x">[</span><span class="mi">1</span><span class="x">])</span><span class="o">/</span><span class="x">(</span><span class="n">x</span><span class="x">[</span><span class="mi">4</span><span class="x">]</span><span class="o">-</span><span class="n">x</span><span class="x">[</span><span class="mi">3</span><span class="x">])</span>
    <span class="k">return</span> <span class="x">[</span><span class="n">x</span><span class="x">[</span><span class="mi">2</span><span class="x">],</span> <span class="n">xnew</span><span class="x">,</span> <span class="n">x</span><span class="x">[</span><span class="mi">4</span><span class="x">],</span> <span class="n">f</span><span class="x">(</span><span class="n">xnew</span><span class="x">)]</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">x_S_f</span><span class="o">=</span><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">f</span><span class="x">,</span><span class="n">Secant</span><span class="x">,[</span><span class="mf">2.</span><span class="x">,</span><span class="mf">1.5</span><span class="x">,</span><span class="n">f</span><span class="x">(</span><span class="mf">2.0</span><span class="x">),</span><span class="n">f</span><span class="x">(</span><span class="mf">1.5</span><span class="x">)],[</span><span class="s">"null"</span><span class="x">],</span><span class="mi">10</span><span class="x">)</span>
<span class="n">dx_S_f</span><span class="o">=</span><span class="n">x_S_f</span><span class="x">[</span><span class="mi">2</span><span class="x">,:]</span><span class="o">-</span><span class="n">x_S_f</span><span class="x">[</span><span class="mi">1</span><span class="x">,:]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>10-element Array{Float64,1}:
  -0.5                   
  -0.4363849163049389    
   0.007916427022864214  
   0.0003336224830581269 
  -4.1258247596154263e-7 
   2.0476065287766687e-11
   0.0                   
 NaN                     
 NaN                     
 NaN                     
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">x_S_x2</span><span class="o">=</span><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">x2</span><span class="x">,</span><span class="n">Secant</span><span class="x">,[</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="o">.</span><span class="mi">8</span><span class="x">,</span><span class="n">x2</span><span class="x">(</span><span class="o">-</span><span class="mf">1.</span><span class="x">),</span><span class="n">x2</span><span class="x">(</span><span class="o">.</span><span class="mi">8</span><span class="x">)],[</span><span class="s">"null"</span><span class="x">],</span><span class="mi">10</span><span class="x">)</span>
<span class="n">dx_S_x2</span><span class="o">=</span><span class="n">x_S_x2</span><span class="x">[</span><span class="mi">2</span><span class="x">,:]</span><span class="o">.-</span><span class="n">x_S_x2</span><span class="x">[</span><span class="mi">2</span><span class="x">,</span><span class="k">end</span><span class="x">]</span>

<span class="n">println</span><span class="x">(</span><span class="s">"ii </span><span class="se">\t</span><span class="s"> Guess </span><span class="se">\t\t\t</span><span class="s"> dx"</span><span class="x">)</span>
<span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">length</span><span class="x">(</span><span class="n">x_S_x2</span><span class="x">[</span><span class="mi">1</span><span class="x">,:])</span>
    <span class="n">println</span><span class="x">(</span><span class="n">ii</span><span class="x">,</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="x">,</span><span class="n">x_S_x2</span><span class="x">[</span><span class="mi">2</span><span class="x">,</span><span class="n">ii</span><span class="x">],</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="x">,</span><span class="n">dx_S_x2</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>ii 	 Guess 			 dx
1	0.8	0.7712230215827338
2	4.000000000000002	3.9712230215827358
3	0.6666666666666665	0.6378896882494003
4	0.5714285714285714	0.5426515930113052
5	0.30769230769230765	0.2789153292750415
6	0.19999999999999998	0.17122302158273378
7	0.1212121212121212	0.09243514279485501
8	0.07547169811320753	0.04669471969594134
9	0.046511627906976744	0.017734649489710555
10	0.02877697841726619	0.0
</code></pre>
</div>

<p>Working … kinda ?</p>

<p>But when you think geometrically about what this situation is, I’m rather amazed that this set of initial points $(-1, .8)$ works at all.  Look at the limiting situation of $(-a,a)$ to get an idea of when the method can fail completely.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">x2</span><span class="x">,</span><span class="n">Secant</span><span class="x">,[</span><span class="o">-</span><span class="mf">1.</span><span class="x">,</span><span class="mf">1.</span><span class="x">,</span><span class="n">x2</span><span class="x">(</span><span class="o">-</span><span class="mf">1.</span><span class="x">),</span><span class="n">x2</span><span class="x">(</span><span class="mf">1.</span><span class="x">)],[</span><span class="s">"null"</span><span class="x">],</span><span class="mi">10</span><span class="x">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>4×10 Array{Float64,2}:
 -1.0     1.0  -Inf  NaN  NaN  NaN  NaN  NaN  NaN  NaN
  1.0  -Inf     NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN
  1.0     1.0   Inf  NaN  NaN  NaN  NaN  NaN  NaN  NaN
  1.0   Inf     NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN
</code></pre>
</div>

<h2 id="regula--falsi-method">Regula- Falsi Method</h2>

<p>The Regula- Falsi Method combines Midpoint and Secant Method.  It uses the potential speedup due to derivatives, but avoids some pitfalls by staying bracketed.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="k">function</span><span class="nf"> RegulaFalsi</span><span class="x">(</span><span class="n">f</span><span class="o">::</span><span class="n">Function</span><span class="x">,</span> <span class="n">x</span><span class="o">::</span><span class="n">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">},</span><span class="n">params</span><span class="x">)</span>
    <span class="k">if</span> <span class="n">f</span><span class="x">(</span><span class="n">x</span><span class="x">[</span><span class="mi">1</span><span class="x">])</span><span class="o">*</span><span class="n">f</span><span class="x">(</span><span class="n">x</span><span class="x">[</span><span class="mi">2</span><span class="x">])</span><span class="o">&gt;</span><span class="mi">0</span>
        <span class="n">println</span><span class="x">(</span><span class="s">"Endpoints must bracket a zero.  Please pick better endpoints."</span><span class="x">)</span>
        <span class="nb">error</span><span class="x">()</span>
    <span class="k">end</span>
    
    <span class="n">c</span><span class="o">=</span> <span class="n">x</span><span class="x">[</span><span class="mi">2</span><span class="x">]</span> <span class="o">-</span> <span class="n">x</span><span class="x">[</span><span class="mi">4</span><span class="x">]</span><span class="o">*</span><span class="x">(</span><span class="n">x</span><span class="x">[</span><span class="mi">2</span><span class="x">]</span><span class="o">-</span><span class="n">x</span><span class="x">[</span><span class="mi">1</span><span class="x">])</span><span class="o">/</span><span class="x">(</span><span class="n">x</span><span class="x">[</span><span class="mi">4</span><span class="x">]</span><span class="o">-</span><span class="n">x</span><span class="x">[</span><span class="mi">3</span><span class="x">])</span>
    
    <span class="k">if</span> <span class="n">f</span><span class="x">(</span><span class="n">x</span><span class="x">[</span><span class="mi">1</span><span class="x">])</span><span class="o">*</span><span class="n">f</span><span class="x">(</span><span class="n">c</span><span class="x">)</span><span class="o">&lt;</span><span class="mi">0</span>
        <span class="k">return</span> <span class="x">[</span> <span class="n">x</span><span class="x">[</span><span class="mi">1</span><span class="x">],</span><span class="n">c</span><span class="x">,</span><span class="n">x</span><span class="x">[</span><span class="mi">3</span><span class="x">],</span><span class="n">f</span><span class="x">(</span><span class="n">c</span><span class="x">)</span> <span class="x">,</span> <span class="n">c</span><span class="x">]</span>
        
    <span class="k">elseif</span> <span class="n">f</span><span class="x">(</span><span class="n">c</span><span class="x">)</span><span class="o">*</span><span class="n">f</span><span class="x">(</span><span class="n">x</span><span class="x">[</span><span class="mi">2</span><span class="x">])</span><span class="o">&lt;</span><span class="mi">0</span>
        <span class="k">return</span> <span class="x">[</span><span class="n">c</span><span class="x">,</span> <span class="n">x</span><span class="x">[</span><span class="mi">2</span><span class="x">],</span> <span class="n">f</span><span class="x">(</span><span class="n">c</span><span class="x">)</span> <span class="x">,</span> <span class="n">x</span><span class="x">[</span><span class="mi">4</span><span class="x">]</span> <span class="x">,</span> <span class="n">c</span><span class="x">]</span>
        
    <span class="k">elseif</span> <span class="n">f</span><span class="x">(</span><span class="n">c</span><span class="x">)</span> <span class="o">==</span><span class="mi">0</span> 
        <span class="n">print</span><span class="x">(</span><span class="s">"midpoint is zero"</span><span class="x">)</span>
        <span class="k">return</span> <span class="x">[</span><span class="n">x</span><span class="x">,</span><span class="n">x</span><span class="x">,</span><span class="n">f</span><span class="x">(</span><span class="n">c</span><span class="x">),</span><span class="n">f</span><span class="x">(</span><span class="n">c</span><span class="x">)</span> <span class="x">,</span> <span class="n">c</span><span class="x">]</span>
    <span class="k">else</span>   
        <span class="n">println</span><span class="x">(</span><span class="s">"Mid point doesn't bracket a zero... somethign weird..."</span><span class="x">)</span>
        <span class="n">print</span><span class="x">(</span><span class="n">c</span><span class="x">,</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="x">,</span><span class="n">f</span><span class="x">(</span><span class="n">c</span><span class="x">))</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">x_RF_f</span><span class="o">=</span><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">f</span><span class="x">,</span><span class="n">RegulaFalsi</span><span class="x">,[</span><span class="o">-</span><span class="mf">1.</span><span class="x">,</span><span class="mf">2.</span><span class="x">,</span><span class="n">f</span><span class="x">(</span><span class="o">-</span><span class="mf">1.</span><span class="x">),</span><span class="n">f</span><span class="x">(</span><span class="mf">2.</span><span class="x">),</span><span class="o">-</span><span class="mf">1.</span><span class="x">],[</span><span class="s">"null"</span><span class="x">],</span><span class="mi">10</span><span class="x">)</span>
<span class="n">dx_RF_f</span><span class="o">=</span><span class="n">x_RF_f</span><span class="x">[</span><span class="mi">5</span><span class="x">,:]</span><span class="o">.-</span><span class="n">x_RF_f</span><span class="x">[</span><span class="k">end</span><span class="x">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>10-element Array{Float64,1}:
 -2.071864720637038    
 -0.6537077548263073   
 -0.06880892316102294  
 -0.00260388104164222  
 -7.907110959903818e-5 
 -2.3785634690742796e-6
 -7.152788894515538e-8 
 -2.1491297630404915e-9
 -6.274269992445625e-11
  0.0                  
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">f</span>
    <span class="x">,</span><span class="n">xlims</span><span class="o">=</span><span class="x">(</span><span class="o">-</span><span class="mf">1.5</span><span class="x">,</span><span class="mf">2.5</span><span class="x">),</span><span class="n">ylims</span><span class="o">=</span><span class="x">(</span><span class="o">-</span><span class="mf">2.5</span><span class="x">,</span><span class="mi">3</span><span class="x">),</span><span class="n">legend</span><span class="o">=</span><span class="n">false</span><span class="x">)</span>
<span class="n">hline!</span><span class="x">([</span><span class="mi">0</span><span class="x">])</span>
<span class="n">plot!</span><span class="x">(</span><span class="n">x_RF_f</span><span class="x">[</span><span class="mi">1</span><span class="x">:</span><span class="mi">2</span><span class="x">,:],</span><span class="n">x_RF_f</span><span class="x">[</span><span class="mi">3</span><span class="x">:</span><span class="mi">4</span><span class="x">,:],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="x">)</span>

<span class="n">plot!</span><span class="x">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s">"x"</span><span class="x">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s">"y"</span><span class="x">,</span><span class="n">title</span><span class="o">=</span><span class="s">"Regula Falsi Method"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Roots/output_40_0.svg" alt="Regula-Falsi Method" />
    
    
        <p class="image-caption"></p>
    
</div>

<p>So when might we want to use this trait of staying bracketed?</p>

<p>Let’s apply this algorithm to the cube root function $\sqrt[3]{x}$ that the Newton-Raphson method failed so miserably on:</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">x_RF_cubert</span><span class="o">=</span><span class="n">Zero_Iterator</span><span class="x">(</span><span class="n">cubert</span><span class="x">,</span><span class="n">RegulaFalsi</span><span class="x">,[</span><span class="o">-</span><span class="mf">1.</span><span class="x">,</span><span class="mf">2.</span><span class="x">,</span><span class="n">cubert</span><span class="x">(</span><span class="o">-</span><span class="mf">1.</span><span class="x">),</span><span class="n">cubert</span><span class="x">(</span><span class="mf">2.</span><span class="x">),</span><span class="o">-</span><span class="mf">1.</span><span class="x">],[</span><span class="s">"null"</span><span class="x">],</span><span class="mi">10</span><span class="x">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>5×10 Array{Float64,2}:
 -1.0      -1.0       -0.214174  -0.214174   …  -0.00114702  -0.00114702
  2.0       0.32748    0.32748    0.0375178      0.00141547   8.93351e-5
 -1.0      -1.0       -0.598304  -0.598304      -0.104678    -0.104678  
  1.25992   0.689279   0.689279   0.33477        0.112279     0.0447034 
 -1.0       0.32748   -0.214174   0.0375178     -0.00114702   8.93351e-5
</code></pre>
</div>

<p>And that Regula Falsi actually converges to $0$ instead of running off to infinity! Yay!</p>

<h2 id="comparison-of-results">Comparison of Results</h2>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">abs</span><span class="o">.</span><span class="x">(</span><span class="n">dx_M_f</span><span class="o">/</span><span class="n">dx_M_f</span><span class="x">[</span><span class="mi">1</span><span class="x">])</span><span class="o">.+</span><span class="mf">1e-10</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Midpoint Method"</span><span class="x">)</span>
<span class="n">plot!</span><span class="x">(</span><span class="n">abs</span><span class="o">.</span><span class="x">(</span><span class="n">dx_NR_f</span><span class="o">/</span><span class="n">dx_NR_f</span><span class="x">[</span><span class="mi">1</span><span class="x">])</span><span class="o">.+</span><span class="mf">1e-10</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Newton-Raphson"</span><span class="x">)</span>
<span class="n">plot!</span><span class="x">(</span><span class="n">abs</span><span class="o">.</span><span class="x">(</span><span class="n">dx_S_f</span><span class="o">/</span><span class="n">dx_S_f</span><span class="x">[</span><span class="mi">1</span><span class="x">])</span><span class="o">.+</span><span class="mf">1e-10</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Secant"</span><span class="x">)</span>
<span class="n">plot!</span><span class="x">(</span><span class="n">abs</span><span class="o">.</span><span class="x">(</span><span class="n">dx_RF_f</span><span class="o">/</span><span class="n">dx_RF_f</span><span class="x">[</span><span class="mi">1</span><span class="x">])</span><span class="o">.+</span><span class="mf">1e-10</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Regula Falsi"</span><span class="x">)</span>

<span class="n">plot!</span><span class="x">(</span><span class="n">yscale</span><span class="o">=</span><span class="x">:</span><span class="n">log</span><span class="x">,</span><span class="n">legend</span><span class="o">=</span><span class="x">:</span><span class="n">bottomleft</span><span class="x">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s">"Iterations"</span><span class="x">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s">"Difference from Final"</span><span class="x">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s">"Comparison of Root Finding Methods"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Roots/output_45_0.svg" alt="Comparison of Convergence Rates" />
    
    
        <p class="image-caption"></p>
    
</div>

<p>In comparing the convergence rates on a non-complicated transcendental function, we see that NR converges the fastest, followed by Secant, then Regula-Falsi, and finally the Midpoint method.</p>

<p>But the NR and Secant Methods have about the same slope once the algorithm is “burned in”, or less affected by our crappy initial choices.</p>

<p>Remember, that I could only really even make this plot for the function ‘f’.  The other functions broke down on one or more methods  … though I did choose the functions because they would break down…</p>

<p>$x^2$ can’t be bracketed and therefore does not apply to either the Midpoint method or Regula Falsi.  The loop function $x^3-2x+2$ would never converge.  $1/x$ could have a divergence misinterpreted as a zero. The Cuberoot $\sqrt[3]{x}$ runs off to infinity on the NR method.</p>

<p>From this, remember:</p>

<p><b>One Method Does Not Rule Them All</b></p>

<h2 id="what-next">What Next?</h2>

<p>Awesome bonus to 1D root finding: Fractals!</p>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Roots/zeros_fractal.png" alt="Newton Fractal" />
    
    
        <p class="image-caption"></p>
    
</div>

<p>If we color the complex plane by which zero of $x^3-1$ each point will converge to under the Newton-Raphson method, we generate this awesome picture.</p>

<p>After 1D Roots, I hope to look at 2+D Roots, which are supprisingly much more complicated.  But most problems are not in one dimension, so it’s about time I learned some of those methods.</p>

<p>I got onto root finding through boundary value problems, so hopefully I’ll have something about that soon too.</p>

  </article>

</div>

      </div>
    </div>

    <div class="comment">
<!-- Add Disqus comments. -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'M4julia'; // required: replace example with your forum shortname
  var disqus_identifier = "/Roots_1D.html";

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>

    <footer class="site-footer">
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>


  <div class="wrapper">

    <h2 class="footer-heading">Metals, Magnets, and Miscellaneous Materials</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Metals, Magnets, and Miscellaneous Materials</li>
          <li><a href="mailto:chrissie.c.l@gmail.com">chrissie.c.l@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/albi3ro">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">albi3ro</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/PyrochloreLee">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">PyrochloreLee</span>
            </a>
          </li>
          
          <li>
              <div class="fb-share-button"
               data-href="/M4/Roots_1D.html" data-layout="button_count"></div>

          </li>
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Blog Introduction to Computational Condensed Matter Physics</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-70984222-1', 'auto');
  ga('send', 'pageview');

</script>
