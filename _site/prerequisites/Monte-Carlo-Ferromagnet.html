<!DOCTYPE html>
<html>


  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Monte Carlo Ferromagnet</title>
    <!-- <meta name="description" content="Blog Introduction to Computational Condensed Matter Physics"> -->
    <link rel="stylesheet" href="/M4/css/main.css">
    <link rel="canonical" href="http://localhost:4000/M4/prerequisites/Monte-Carlo-Ferromagnet.html">
    <meta name="google-site-verification" content="FLWeXTRDBUYGSJXcdiUyqbwExBElCj76l3EdhtLL-wI" />
          <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [ ['$','$'], ['\(', '\)'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true,
    }
  });
</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


    <meta property="og:title" content="Monte Carlo Ferromagnet" />
    <meta property="og:image" content="{{base.url}}/M4/Images/Ferromagnet/ParamagnetL30_b2.gif" />
    <meta property="twitter:card" content="summary" />
    <meta property="twitter:site" content="@PyrochloreLee" />
    <meta property="twitter:title" content="Monte Carlo Ferromagnet" />
    <meta property="twitter:image" content="{{base.url}}/M4/Images/Ferromagnet/ParamagnetL30_b2.gif" />
    <meta property="twitter:description" content="" />

</head>


  <body>


    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/M4/">Metals, Magnets, and Miscellaneous Materials</a>

    <link rel="icon"
      type="image/png"
      href="/M4/Images/favicon.ico">

    <!--<nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
      </svg>
    </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/M4/about/">About</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/M4/jupyterjulia/">Interacting with Julia</a>
          
        
          
        
          
        
          
          <a class="page-link" href="/M4/tags/Lattices/">Posts Tagged &ldquo;Lattices&rdquo;</a>
          
        
          
          <a class="page-link" href="/M4/tags/Quantum/">Posts Tagged &ldquo;Quantum&rdquo;</a>
          
        
          
          <a class="page-link" href="/M4/tags/ED/">Posts Tagged &ldquo;ED&rdquo;</a>
          
        
          
          <a class="page-link" href="/M4/tags/Monte%20Carlo/">Posts Tagged &ldquo;Monte Carlo&rdquo;</a>
          
        
          
          <a class="page-link" href="/M4/tags/Magnet/">Posts Tagged &ldquo;Magnet&rdquo;</a>
          
        
          
          <a class="page-link" href="/M4/tags/Plot/">Posts Tagged &ldquo;Plot&rdquo;</a>
          
        
          
          <a class="page-link" href="/M4/tags/ODE/">Posts Tagged &ldquo;ODE&rdquo;</a>
          
        
          
          <a class="page-link" href="/M4/tags/Intro/">Posts Tagged &ldquo;Intro&rdquo;</a>
          
        
      </div>
    </nav>-->

  </div>

</header>




    <div class="page-content">
        <div class="downloadzp"><a href="https://github.com/albi3ro/M4/archive/master.zip" class="sidebar">Zip!</a></div>

        <div class="clonelink"><a href="https://github.com/albi3ro/M4.git" class="sidebar">Clone!</a></div>

        <div class="juliadocs"><a href="http://docs.julialang.org/en/latest/manual/" class="sidebar">Docs</a></div>

        <div class="juliahelp"><a href="/M4/jupyterjulia" class="sidebar">Interact</a></div>

        <div class="about"><a href="/M4/about" class="sidebar">About</a></div>

      <div class="wrapper">
        <div class="post">
<meta name="description" content="" />
<meta name="keywords" content="Magnet" />
<meta name="author" content="Christina C. Lee" />

  <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

  <header class="post-header">
    <h1 class="post-title" itemprop="name">Monte Carlo Ferromagnet</h1>
    <p class="post-meta">Author: Christina C. Lee &nbsp;&nbsp;&nbsp;&nbsp;
      Category: <a href="/M4/categories">
        Prerequisites</a> &nbsp;  &nbsp; &nbsp; &nbsp;
        Tags:
      
      <a href="/M4/tags">Magnet</a></p>
        
  </header>

  <article class="post-content">

    <p>Post Prerequisites: <a href="/M4/numerics/Monte-Carlo.html">Monte Carlo Calculation of pi</a>, <a href="/M4/numerics/MCMC.html">Monte Carlo Markov Chain</a></p>

<p>Prerequisites: Statistical Mechanics</p>

<h2 id="the-physics">The physics</h2>

<p>What process turns liquid water into a solid?  As temperature lowers, materials transition from a regime where the desire to maximize entropy dominates to desiring to minimize energy.   In transitions like liquid-solid, the energy arises from atom-atom forces.  This problem falls into a category called first order phase transitions, which are difficult to study.</p>

<p>Instead of looking at the liquid-solid problem to understand phase transitions, we will look at a magnetic material undergoing a second order phase transition. In our approximation of the problem, the atoms exist at fixed positions on a lattice, and interact with their neighbor according to the following Hamiltonian,
\begin{equation}
    {\cal H} = -J \sum_{&lt;i,j&gt;} S^z_i S_j^z
\end{equation}
, which is basically just the energy.  This <i>Ising</i> Model has nearest neighbors interacting, and each spin variablesolely points in the $\pm z$ direction.</p>

<p>At a given temperature $T$, inverse temperature $\beta=1/T$, $k_b=1$, the occupancy of a given configuration $c_i$ follows the Maxwell-Boltzmann Probability Distribution,
\begin{equation}
P(c_i)=\frac{\mathrm{e}^{-\beta E(c_i)}}{\sum\limits_j \mathrm{e}^{-\beta E(c_j)}}
\end{equation}
We need to determine observables given this probability distribution.</p>

<h2 id="the-numerics">The Numerics</h2>

<p>In the post on the Markov Chain, each state was a location on our grid.  Now our state is one configuration of all our $N$ spins.  That means for an Ising spin we have $2^N$ different configurations.  Yeah… We aren’t going to be exploring all of those.</p>

<p>So how do we get from one state to the next?</p>

<p>First, we choose a spin that we could flip.  This potential spin is chosen randomly for convenience’s sake.</p>

<p>Then we use the <b>Metropolis-Hastings Algorithm</b> to decide whether or no to flip the spin and generate a new configuration.</p>

<p>We split the solution into two cases based on $\alpha = \frac{\pi_i}{\pi_j}= \frac{P(c_i)}{P(c_j)}$:</p>

<ul>
  <li>If $\alpha &gt; 1$ then always accept the transition, $p_{i \to j} = 1$</li>
  <li>If $\alpha &lt; 1$, accept the transition with probability $\alpha = p_{i \to j}$</li>
</ul>

<p><b>Does this obey detailed balance? </b></p>

<p>From the Monte Carlo Markov Chain post, we take our equation for detailed balance</p>

<p>\begin{equation}
\frac{p_{i \to j}}{ p_{j \to i}} = \frac{\pi_i}{\pi_j}
\end{equation}</p>

<p>How about ergodicity? We can reach any configuration by flipping spins.</p>

<p>For the Ising Ferromagnet, our $\alpha$ is
\begin{equation}
\alpha= \frac{Z}{Z} \frac{\mathrm{e}^{-\beta E_i}}{\mathrm{e}^{-\beta E_j}}
= \mathrm{e}^{\beta \left(E_j - E_i \right)}
\end{equation}
which is simply a function of difference in energy between two states.  Therefore we don’t need to know the absolute energy at each point in time, just how the spin flip changes its local environment.</p>

<h2 id="tunable-parameters">Tunable Parameters</h2>

<p>I will say a little bit about the tunable parameters here, but Monte Carlo simulations are as much an art as a science, so I leave it up to you to play with the numbers and build intuition for what works.</p>

<h3 id="temperature">Temperature</h3>
<div class="image-wrapper">
<img src="/M4/Images/Ferromagnet/couch1.JPG" width="200px" style="float: left; margin: 20px" />
</div>
<div class="image-wrapper">
 <img src="/M4/Images/Ferromagnet/mountain.jpg" width="200px" style="float: right; margin: 20px" />
</div>

<p>On the left I am performing a low temperature search of a couch store.  I found a minimum, and even though I got stuck there, I thoroughly got to know what that minimum had to offer. On the right though, I’m performing a high temperature search of the Alexander Hills, Death Valley, California in pursuit of Neoproterzoic carbonates and dimictites.  I needed to be able to explore a lot more of the environment.</p>

<p>While in a physical system like a magnet, temperature has a physical meaning, we can create other types of situations, like optimization or approximating a probability distribution, where we use temperature to describe how stuck we are to a particular minimum.  This intuition also plays a role in interpreting the results of of our simulation.</p>

<p>Temperature can also provide other complications when we are studying critical phenomena, phase transitions.  Near the critical temperature, computations get much more difficult.  Elaboration in later post.</p>

<h3 id="size-of-lattice">Size of Lattice</h3>

<ul>
  <li>Larger lattice gives more precise results.</li>
  <li>Larger lattice takes more memory and time.</li>
  <li>Finite Size effects, to be disscussed later, display some interesting physics.</li>
</ul>

<h3 id="coupling-constant-j">Coupling Constant J</h3>

<p>Usually normalized out anyway…</p>

<h3 id="number-of-time-steps">Number of time steps</h3>

<p>Each Monte Carlo time step is one complete sweep of the lattice, $N$ random flip attempts.  The more time steps, the more accurate the results, but the longer you have to wait.</p>

<h3 id="when-to-measure">When to Measure</h3>

<p>Though a time step does include $N$ spin flips, that doesn’t mean we have actually moved to a truly new configuration.  If we want to randomly sample our configuration space, we need to wait a bit longer to sample.  Too short a time, and our measurements are coupled and not accurate.  Too long, and we are wasting computations.  In a later post, I will look at the autocorrelation time, which is a good way to figure our if your measurement time is good.</p>

<h3 id="other-potential-options">Other potential Options</h3>

<p>Some less important things: periodic versus open boundary conditions, shape and symmetries of simulation cell.</p>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">using</span> <span class="n">PyPlot</span><span class="x">;</span>
<span class="n">push!</span><span class="x">(</span><span class="n">LOAD_PATH</span><span class="x">,</span><span class="s">"."</span><span class="x">)</span>
<span class="n">using</span> <span class="n">Lattices</span><span class="x">;</span></code></pre></figure>

<p>Instead of going into calculating all the lattice parameters again, we will use a class I define in the file Lattices.jl .  This class contains</p>

<p>Lattice Types</p>

<ul>
  <li>Chain</li>
  <li>Square</li>
  <li>Honeycomb
You can edit the file to make your own types.</li>
</ul>

<p>Once a lattice is created, it contains <b>Members of Type</b>:</p>

<ul>
  <li><code class="highlighter-rouge">name</code>, a string</li>
  <li><code class="highlighter-rouge">l</code>, length in number of unit cells</li>
  <li><code class="highlighter-rouge">dim</code>, dimension of lattice</li>
  <li><code class="highlighter-rouge">a</code>, array containing the basis vectors by which positions are generated</li>
  <li><code class="highlighter-rouge">unit</code>, array of positions inside a single unit</li>
  <li><code class="highlighter-rouge">N</code>, number of total sites</li>
  <li><code class="highlighter-rouge">X</code>, array of positions</li>
  <li><code class="highlighter-rouge">nnei</code>, number of nearest neighbors</li>
  <li><code class="highlighter-rouge">neigh</code>, Array of nearest neighbors [i][j], where i is site and j is 1:nnei</li>
</ul>

<p>Today, I will just look at the square lattice, since that indicates much of the standard phase transition properties.  Some of the lattices I have shown (kagome, triangular, …) are special frustrated lattices, and thus will behave very wierdly in this situation.</p>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="c">## Define l here</span>
<span class="n">l</span><span class="o">=</span><span class="mi">50</span><span class="x">;</span>

<span class="n">lt</span><span class="o">=</span><span class="n">MakeLattice</span><span class="x">(</span><span class="s">"Square"</span><span class="x">,</span><span class="n">l</span><span class="x">);</span>
<span class="n">S</span><span class="o">=</span><span class="n">ones</span><span class="x">(</span><span class="kt">Int8</span><span class="x">,</span><span class="n">l</span><span class="x">,</span><span class="n">l</span><span class="x">);</span>  <span class="c">#Our spins</span>
<span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="x">(</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">);</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="c"># The energy contribution of just one site</span>
<span class="k">function</span><span class="nf"> dE</span><span class="x">(</span><span class="n">i</span><span class="o">::</span><span class="kt">Int</span><span class="x">)</span>
    <span class="n">Eii</span><span class="o">=</span><span class="mi">0</span><span class="x">;</span>
    <span class="k">for</span> <span class="n">j</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">lt</span><span class="o">.</span><span class="n">nnei</span>
        <span class="n">Eii</span><span class="o">+=</span><span class="n">S</span><span class="x">[</span><span class="n">lt</span><span class="o">.</span><span class="n">neigh</span><span class="x">[</span><span class="n">i</span><span class="x">,</span><span class="n">j</span><span class="x">]];</span>
    <span class="k">end</span>
    <span class="n">Eii</span><span class="o">*=-</span><span class="n">J</span><span class="o">*</span><span class="n">S</span><span class="x">[</span><span class="n">i</span><span class="x">];</span>  <span class="c"># we are computing J sz_i sz_j for one i</span>
    <span class="k">return</span> <span class="n">Eii</span><span class="x">;</span>
<span class="k">end</span>
<span class="c"># The energy of the entire lattice</span>
<span class="k">function</span><span class="nf"> E</span><span class="x">()</span>
    <span class="n">Evar</span><span class="o">=</span><span class="mi">0</span><span class="x">;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span>
        <span class="n">Evar</span><span class="o">+=.</span><span class="mi">5</span><span class="o">*</span><span class="n">dE</span><span class="x">(</span><span class="n">k</span><span class="x">);</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="n">Evar</span><span class="x">;</span>
<span class="k">end</span>
<span class="c"># The magnetization of the entire lattice</span>
<span class="k">function</span><span class="nf"> M</span><span class="x">()</span>
    <span class="n">Mvar</span><span class="o">=</span><span class="mi">0</span><span class="x">;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span>
        <span class="n">Mvar</span><span class="o">+=</span><span class="n">S</span><span class="x">[</span><span class="n">k</span><span class="x">];</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="n">Mvar</span><span class="x">;</span>
<span class="k">end</span>
<span class="s">"defined functions"</span></code></pre></figure>

<h1 id="adjustable-parameters">Adjustable Parameters</h1>

<p>I have set up the simulation so that you can perform two different things.  For one, you can set <code class="highlighter-rouge">video=true</code> and <code class="highlighter-rouge">t</code> to a small variable.  Then in a new window you see what the configuration looks like each time you measure.</p>

<p>Or you can set <code class="highlighter-rouge">video=false</code> and <code class="highlighter-rouge">t</code> to a large variable, and actually measure the statistics for the system over a bunch of configurations.</p>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">beta</span><span class="o">=.</span><span class="mi">7</span><span class="x">;</span>
<span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="x">;</span>
<span class="n">t</span><span class="o">=</span><span class="mi">100000</span><span class="x">;</span>
<span class="n">video</span><span class="o">=</span><span class="n">false</span><span class="x">;</span>
<span class="n">nskip</span><span class="o">=</span><span class="mi">10</span><span class="x">;</span>   <span class="c"># don't measure every sweep= better decorrelation</span>
<span class="s">"Parameters set"</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">nmeas</span><span class="o">=</span><span class="kt">Int64</span><span class="x">(</span><span class="n">t</span><span class="o">/</span><span class="n">nskip</span><span class="x">);</span> <span class="c"># how many times we will measure</span>
<span class="n">Ma</span><span class="o">=</span><span class="n">Array</span><span class="x">{</span><span class="kt">Int32</span><span class="x">}(</span><span class="n">nmeas</span><span class="x">);</span> <span class="c"># our magnetization measurements</span>
<span class="n">Ea</span><span class="o">=</span><span class="n">Array</span><span class="x">{</span><span class="kt">Int32</span><span class="x">}(</span><span class="n">nmeas</span><span class="x">);</span> <span class="c"># our energy measurements</span>
<span class="s">"done"</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">tm</span><span class="o">=</span><span class="mi">1</span><span class="x">;</span> <span class="c">#Our measurement time step</span>
<span class="n">pygui</span><span class="x">(</span><span class="n">true</span><span class="x">)</span>
<span class="k">for</span> <span class="n">ti</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">t</span>
    <span class="k">for</span> <span class="n">j</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">rand</span><span class="x">(</span><span class="mi">1</span><span class="x">:</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">);</span> <span class="c">#Choosing a random site</span>
        <span class="n">de</span><span class="o">=</span><span class="n">dE</span><span class="x">(</span><span class="n">i</span><span class="x">);</span>
        <span class="k">if</span><span class="x">(</span><span class="n">de</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">rand</span><span class="x">()</span><span class="o">&lt;</span><span class="n">exp</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">de</span><span class="x">)</span> <span class="x">)</span>
            <span class="n">S</span><span class="x">[</span><span class="n">i</span><span class="x">]</span><span class="o">=-</span><span class="n">S</span><span class="x">[</span><span class="n">i</span><span class="x">];</span> <span class="c">#Switch the sign</span>
        <span class="k">end</span>
    <span class="k">end</span>
    <span class="k">if</span> <span class="n">isapprox</span><span class="x">(</span><span class="n">mod</span><span class="x">(</span><span class="n">ti</span><span class="x">,</span><span class="n">nskip</span><span class="x">),</span><span class="mi">0</span><span class="x">)</span>
        <span class="n">Ma</span><span class="x">[</span><span class="n">tm</span><span class="x">]</span><span class="o">=</span><span class="n">M</span><span class="x">();</span>
        <span class="n">Ea</span><span class="x">[</span><span class="n">tm</span><span class="x">]</span><span class="o">=</span><span class="n">E</span><span class="x">();</span>
        <span class="n">tm</span><span class="o">+=</span><span class="mi">1</span><span class="x">;</span>

        <span class="k">if</span> <span class="n">video</span><span class="o">==</span><span class="n">true</span>
            <span class="n">pygui</span><span class="x">(</span><span class="n">true</span><span class="x">)</span>
            <span class="n">pcolor</span><span class="x">(</span><span class="n">S</span><span class="x">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">"winter"</span><span class="x">)</span>
            <span class="n">magnow</span><span class="o">=</span><span class="n">round</span><span class="x">(</span><span class="n">M</span><span class="x">()</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">,</span><span class="mi">3</span><span class="x">)</span>
            <span class="n">title</span><span class="x">(</span><span class="s">"t: </span><span class="si">$</span><span class="s">ti  M: </span><span class="si">$</span><span class="s">magnow "</span><span class="x">)</span>
            <span class="n">draw</span><span class="x">()</span>
            <span class="n">sleep</span><span class="x">(</span><span class="o">.</span><span class="mi">5</span><span class="x">)</span>
            <span class="c">#nm=dec(ti,4)</span>
            <span class="c">#savefig("Magnetimages2/pic_l50_bp7_$nm.png")</span>
        <span class="k">end</span>
    <span class="k">end</span>
<span class="k">end</span>
<span class="n">Mave</span><span class="o">=</span><span class="n">mean</span><span class="x">(</span><span class="n">Ma</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">);</span>
<span class="n">Mstd</span><span class="o">=</span><span class="n">std</span><span class="x">(</span><span class="n">Ma</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">);</span>
<span class="n">Eave</span><span class="o">=</span><span class="n">mean</span><span class="x">(</span><span class="n">Ea</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">);</span>
<span class="n">Estd</span><span class="o">=</span><span class="n">std</span><span class="x">(</span><span class="n">Ea</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">);</span>
<span class="n">Mave</span><span class="x">,</span> <span class="n">Mstd</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">pygui</span><span class="x">(</span><span class="n">false</span><span class="x">)</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Magnetization versus Time, Beta=</span><span class="si">$</span><span class="s">beta"</span><span class="x">)</span>
<span class="n">xlabel</span><span class="x">(</span><span class="s">"Monte Carlo Steps"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Average Magnetization"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">collect</span><span class="x">(</span><span class="mi">1</span><span class="x">:</span><span class="mi">10</span><span class="x">:</span><span class="mi">5000</span><span class="x">),</span><span class="n">Ma</span><span class="x">[</span><span class="mi">1</span><span class="x">:</span><span class="mi">500</span><span class="x">]</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">)</span>
<span class="n">annotate</span><span class="x">(</span><span class="s">" White Noise = Well Mixing"</span><span class="x">,</span>
<span class="n">xy</span><span class="o">=</span><span class="x">[</span><span class="mi">500</span><span class="x">,</span> <span class="n">Mave</span> <span class="x">],</span>
<span class="n">xytext</span><span class="o">=</span><span class="x">[</span><span class="mi">1000</span><span class="x">,</span> <span class="n">Mave</span><span class="o">-.</span><span class="mi">0125</span><span class="x">],</span>
    <span class="n">xycoords</span><span class="o">=</span><span class="s">"data"</span><span class="x">,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="n">Dict</span><span class="x">(</span><span class="s">"facecolor"</span><span class="o">=&gt;</span><span class="s">"green"</span><span class="x">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">pygui</span><span class="x">(</span><span class="n">false</span><span class="x">)</span>
<span class="n">plt</span><span class="x">[:</span><span class="n">hist</span><span class="x">](</span><span class="n">Ma</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="x">,</span><span class="n">normed</span><span class="o">=</span><span class="n">true</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Samples Normed"</span><span class="x">);</span>
<span class="n">x</span><span class="o">=</span><span class="n">collect</span><span class="x">(</span><span class="n">Mave</span><span class="o">-</span><span class="n">Mstd</span><span class="o">*</span><span class="mi">3</span><span class="x">:</span><span class="o">.</span><span class="mi">001</span><span class="x">:</span><span class="n">Mave</span><span class="o">+</span><span class="n">Mstd</span><span class="o">*</span><span class="mi">3</span><span class="x">)</span>
<span class="n">gaussian</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="x">(</span><span class="n">Mstd</span><span class="o">*</span><span class="n">sqrt</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="x">))</span><span class="o">*</span><span class="n">exp</span><span class="x">(</span><span class="o">-</span><span class="x">(</span><span class="n">x</span><span class="o">-</span><span class="n">Mave</span><span class="x">)</span><span class="o">.^</span><span class="mi">2</span><span class="o">/</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Mstd</span><span class="o">^</span><span class="mi">2</span><span class="x">));</span>
<span class="n">plot</span><span class="x">(</span><span class="n">x</span><span class="x">,</span><span class="n">gaussian</span><span class="x">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Gaussian Fit"</span><span class="x">)</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Magnetization Sample Distribution beta=</span><span class="si">$</span><span class="s">beta"</span><span class="x">)</span>
<span class="n">xlabel</span><span class="x">(</span><span class="s">"Mangetization"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Normed Counts"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">(</span><span class="n">loc</span><span class="o">=</span><span class="s">"upper right"</span><span class="x">)</span>
<span class="c">#savefig("Ferromagnet/maghist_bp3.png")</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">pygui</span><span class="x">(</span><span class="n">false</span><span class="x">)</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Energy versus Time, Beta=</span><span class="si">$</span><span class="s">beta"</span><span class="x">)</span>
<span class="n">xlabel</span><span class="x">(</span><span class="s">"Monte Carlo Steps"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Average Energy"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">collect</span><span class="x">(</span><span class="mi">1</span><span class="x">:</span><span class="mi">10</span><span class="x">:</span><span class="mi">5000</span><span class="x">),</span><span class="n">Ea</span><span class="x">[</span><span class="mi">1</span><span class="x">:</span><span class="mi">500</span><span class="x">]</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">)</span>
<span class="n">annotate</span><span class="x">(</span><span class="s">" White Noise = Well Mixing"</span><span class="x">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="x">[</span><span class="mi">500</span><span class="x">,</span> <span class="n">Eave</span> <span class="x">],</span>
<span class="n">xytext</span><span class="o">=</span><span class="x">[</span><span class="mi">1000</span><span class="x">,</span> <span class="n">Eave</span><span class="o">-.</span><span class="mi">03</span><span class="x">],</span>
   <span class="n">xycoords</span><span class="o">=</span><span class="s">"data"</span><span class="x">,</span>
   <span class="n">arrowprops</span><span class="o">=</span><span class="n">Dict</span><span class="x">(</span><span class="s">"facecolor"</span><span class="o">=&gt;</span><span class="s">"green"</span><span class="x">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">pygui</span><span class="x">(</span><span class="n">false</span><span class="x">)</span>
<span class="n">plt</span><span class="x">[:</span><span class="n">hist</span><span class="x">](</span><span class="n">Ea</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="x">,</span><span class="n">normed</span><span class="o">=</span><span class="n">true</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Samples Normed"</span><span class="x">);</span>
<span class="n">x</span><span class="o">=</span><span class="n">collect</span><span class="x">(</span><span class="n">Eave</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">Estd</span><span class="x">:</span><span class="o">.</span><span class="mi">001</span><span class="x">:</span><span class="n">Eave</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">Estd</span><span class="x">)</span>
<span class="n">gaussian</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="x">(</span><span class="n">Estd</span><span class="o">*</span><span class="n">sqrt</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="x">))</span><span class="o">*</span><span class="n">exp</span><span class="x">(</span><span class="o">-</span><span class="x">(</span><span class="n">x</span><span class="o">-</span><span class="n">Eave</span><span class="x">)</span><span class="o">.^</span><span class="mi">2</span><span class="o">/</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Estd</span><span class="o">^</span><span class="mi">2</span><span class="x">));</span>
<span class="n">plot</span><span class="x">(</span><span class="n">x</span><span class="x">,</span><span class="n">gaussian</span><span class="x">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Gaussian Fit"</span><span class="x">)</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Energy Histogram, beta=</span><span class="si">$</span><span class="s">beta"</span><span class="x">)</span>
<span class="n">xlabel</span><span class="x">(</span><span class="s">"Energy"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Normed Counts"</span><span class="x">)</span>
<span class="c">#savefig("Ferromagnet/Ehist_bp3.png")</span></code></pre></figure>

<h1 id="example-results">Example Results</h1>
<p>So here are some example results I got.</p>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Ferromagnet/ParamagnetL30_b2.gif" alt="Paramagnet" />
    
    
        <p class="image-caption">States of a Paramagnet at $\beta=0.2$</p>
    
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Ferromagnet/mt.png" alt="Samples over Time" />
    
    
        <p class="image-caption">Paramagnet Magnetization Samples.  A properly tuned simulations should be showing white noise without correlations or getting stuck in particular areas.</p>
    
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Ferromagnet/maghist_bp3.png" alt="Magnetization Histogram" />
    
    
        <p class="image-caption">Magnetization Histogram</p>
    
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Ferromagnet/Ehist_bp3.png" alt="Energy Histogram" />
    
    
        <p class="image-caption">Energy Histogram</p>
    
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Ferromagnet/Magnet_betap7.gif" alt="Magnet" />
    
    
        <p class="image-caption">States of a Paramagnet at $\beta=0.7$</p>
    
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Ferromagnet/maghist_bp7.png" alt="Magnet Histogram" />
    
    
        <p class="image-caption">Histogram of a magnetization at $\beta=0.7$</p>
    
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Ferromagnet/Ehist_bp7.png" alt="Energy Histogram" />
    
    
        <p class="image-caption">Histogram of energy at $\beta=0.7$</p>
    
</div>

<h1 id="to-be-covered-later">To be covered later:</h1>

<p>This is an extremely rich problem.  Since this post seems long enough for me already, I’ll leave these to exercises for you right now, or you can wait until I hold your hand through them.</p>

<ul>
  <li>Plot magnetization and energy as a function of temperature</li>
  <li>What’s the transition temperature?</li>
  <li>How does the dispersion change as a function of temperature? Use that to calculate specific heat and susceptibility</li>
  <li>How do results change with system size?</li>
  <li>Change dimension?</li>
  <li>Put it on a different lattice.  BE CAREFUL of lattices like triangular, checkerboard, pyrochlore, …</li>
  <li>Ferromagnetic versus Antiferromagnetic coupling</li>
  <li>Autocorrelation function</li>
  <li>Structure Factorm, Fourier Transform</li>
</ul>

  </article>

</div>

      </div>
    </div>

    <div class="comment">
<!-- Add Disqus comments. -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'M4julia'; // required: replace example with your forum shortname
  var disqus_identifier = "/prerequisites/Monte-Carlo-Ferromagnet.html";

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>

    <footer class="site-footer">
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>


  <div class="wrapper">

    <h2 class="footer-heading">Metals, Magnets, and Miscellaneous Materials</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Metals, Magnets, and Miscellaneous Materials</li>
          <li><a href="mailto:chrissie.c.l@gmail.com">chrissie.c.l@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/albi3ro">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">albi3ro</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/PyrochloreLee">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">PyrochloreLee</span>
            </a>
          </li>
          
          <li>
              <div class="fb-share-button"
               data-href="/M4/prerequisites/Monte-Carlo-Ferromagnet.html" data-layout="button_count"></div>

          </li>
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Blog Introduction to Computational Condensed Matter Physics</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-70984222-1', 'auto');
  ga('send', 'pageview');

</script>
