<!DOCTYPE html>
<html>


  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Phase Transitions</title>
    <!-- <meta name="description" content="Blog Introduction to Computational Condensed Matter Physics"> -->
    <link rel="stylesheet" href="/M4/css/main.css">
    <link rel="canonical" href="http://localhost:4000/M4/Phase-Transitions.html">
    <meta name="google-site-verification" content="FLWeXTRDBUYGSJXcdiUyqbwExBElCj76l3EdhtLL-wI" />
          <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [ ['$','$'], ['\(', '\)'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true,
    }
  });
</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


    <meta property="og:title" content="Phase Transitions" />
    <meta property="og:image" content="https://albi3ro.github.io/M4/Images/PhaseTransitions/output_23_0.png" />
    <meta property="twitter:card" content="summary" />
    <meta property="twitter:site" content="@PyrochloreLee" />
    <meta property="twitter:title" content="Phase Transitions" />
    <meta property="twitter:image" content="https://albi3ro.github.io/M4/Images/PhaseTransitions/output_23_0.png" />
    <meta property="twitter:description" content="A look at phase transitions in magnets using a Metropolis-Hastings Algorithm, specifically at the square lattice Ising model." />

    <link rel="apple-touch-icon" sizes="180x180" href="/M4/Images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/M4/Images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/M4/Images/favicons/favicon-16x16.png">
    <link rel="manifest" href="/M4/Images/favicons/manifest.json">
    <link rel="mask-icon" href="/M4/Images/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="theme-color" content="#000000">

</head>


  <body>


    <header class="site-header">

  <div>

    <a class="site-title" href="/M4/">Metals, Magnets, and Miscellaneous Materials</a>

    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top" style="float: right">
    <input type="hidden" name="cmd" value="_donations">
    <input type="hidden" name="business" value="chrissie.c.l@gmail.com">
    <input type="hidden" name="lc" value="US">
    <input type="hidden" name="item_name" value="M4">
    <input type="hidden" name="no_note" value="0">
    <input type="hidden" name="currency_code" value="USD">
    <input type="hidden" name="bn" value="PP-DonationsBF:btn_donate_SM.gif:NonHostedGuest">
    <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
    <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
    </form>



  </div>

</header>




    <div class="page-content">
        <div class="downloadzp"><a href="https://github.com/albi3ro/M4/archive/master.zip" class="sidebar">Zip!</a></div>

        <div class="clonelink"><a href="https://github.com/albi3ro/M4.git" class="sidebar">Clone!</a></div>

        <div class="pdfslink"><a href="/M4/pdfs" class="sidebar">PDFs</a></div>

        <div class="juliadocs"><a href="https://docs.julialang.org/" class="sidebar">Docs</a></div>

        <div class="juliahelp"><a href="/M4/jupyterjulia" class="sidebar">Interact</a></div>

        <div class="about"><a href="/M4/about" class="sidebar">About</a></div>

      <div class="wrapper">
        <div class="post">
<meta name="description" content="A look at phase transitions in magnets using a Metropolis-Hastings Algorithm, specifically at the square lattice Ising model." />
<meta name="keywords" content="Magnet" />
<meta name="author" content="Christina C. Lee" />

  <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

  <header class="post-header">
    <h1 class="post-title" itemprop="name">Phase Transitions</h1>
    <p class="post-meta">Author: Christina C. Lee &nbsp;&nbsp;&nbsp;&nbsp;
      Category: <a href="/M4/categories">
        Prerequisites Required</a> &nbsp;  &nbsp; &nbsp; &nbsp;
        Tags:
      
      <a href="/M4/tags#Magnet">Magnet</a>&nbsp; 
        </p>
  </header>

  <article class="post-content">

    <p>Post Prerequisites: <a href="/M4/Monte-Carlo.html">Monte Carlo Calculation of pi</a>, <a href="/M4/MCMC.html">Monte Carlo Markov Chain</a> <a href="/M4/Monte-Carlo-Ferromagnet.html">Monte Carlo Ferromagnet</a></p>

<p>Prerequisites: Statistical Mechanics</p>

<p>In Monte Carlo Ferromagnets, we only looked at the state of a magnet at one temperature.  While I displayed how it looked at both a high temperature and a low-temperature situation, that had to be done manually.  Today we are going to automate our study of temperature’s effect.</p>

<p>First off, what’s the theory?</p>

<p>The standard apparatus for phase transitions is <b>Landau Theory</b>.  In Landau theory, we assume that we have an <b>order parameter</b>.</p>

<p>Order parameters have</p>
<ul>
  <li>local physical meaning</li>
  <li>global observational consequences</li>
</ul>

<p>For example, in magnets we use the local magnetization $m$; in freezing fluids, the difference in density $\rho$.  The value of an order parameter should undergo a jump across a phase transition, usually from a zero to a non-zero value.</p>

<p>To construct Landau theory, we postulate that we can create a <b>Free Energy</b> for the system that is</p>
<ul>
  <li>continuous in the order parameter</li>
  <li>respects the symmetries of the system</li>
</ul>

<p>Given those constraints, we get
\begin{equation}
F=f_0(T) + \alpha_0 (T-T_c) m^2+ \frac{1}{2} \beta m^4 - h m + …
\end{equation}
From this simple equation, we can derive many of the qualitative properties of phase transitions.  I won’t repeat that here, but you can look it up in a Statistical Mechanics textbook.</p>

<p>Non-zero order parameters also represent symmetry breaking.  In an unmagnetized magnet, all directions are equivalent, but once it magnetizes, it chooses a preferred direction.  That direction is arbitrary up until the magnet spontaneously chooses it.</p>

<p>Back in the early days of cars, streets didn’t have lanes and a specified side for cars to drive on.  Driving was symmetric.   When two cars approached each other on the same road, the drivers had to figure out how to avoid a collision, either by everyone going to their left or everyone going to their right.  Eventually, all the cars in a specific area picked up one convention. In the United States, we choose the right side of the road.  In Japan, they chose left.  Neither is wrong; it was pure chance.  The solution breaks the symmetry of the problem.</p>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/PhaseTransitions/symmetrybreaking.svg" alt="Symmetry Breaking" />
    
    
        <p class="image-caption">Though both potentials are symmetric, the low energy solution on the right breaks the symmetry.</p>
    
</div>

<h3 id="specific-heat-and-magnetic-susceptibility">Specific Heat and Magnetic Susceptibility</h3>

<p>In addition to magnetization and energy, today I introduce the physical observables specific heat and magnetic susceptibility.  These numbers describe how the old quantities change with temperature.</p>

<p>Let’s take a look at the first one, <b>Specific Heat</b>:</p>

<script type="math/tex; mode=display">C_h=\frac{d \langle E \rangle}{dT}</script>

<p>While the above is the formal definition, we can calculate a more convenient expression by plugging in the Maxwell-Boltzmann Distribution:</p>

<script type="math/tex; mode=display">\frac{ d
\frac{\sum_{i} E_{i} e^{-\beta E_i}}{ \sum_j e^{-\beta E_j} }
}{dT}=\beta^2 \left( \langle E^2 \rangle - \langle E \rangle ^2 \right)</script>

<p>This equation we use to calculate the specific heat, as it uses the values calculated at only one temperature, eliminating the need for a numerical derivative.  For each temperature, we will need to calculate both the expectation of the Energy and the expectation of the Energy Squared.</p>

<p>While in general, a material may be difficult to describe, near phase transitions certain properties diverge according to corresponding <b>critical exponents</b>.  These fall out of the phenomenology of Landau theory, which you can find more about in a textbook.</p>

<p>These critical exponents obey <b>universality</b>.  Phase transitions in the same class will follow the same critical exponents.  Determining the exponent for the 2D square lattice through our simulations also determines the exponent for situations like the mixing of two materials or the percolation problem.</p>

<p>We define our specific heat critical exponent this way,</p>

<script type="math/tex; mode=display">C_h \propto \left( T- T_c \right)^{-\alpha_{\pm}}.</script>

<p>The divergent scaling of most properties around a critical temperature depends on the divergence of the <b>correlation length</b> $\xi$, the size of fluctuations in the system.  At the critical temperature, fluctuations exist at <i>every length scale</i>.   Once we get close enough to the transition temperature for the fluctuations to become greater than our finite simulation lattice, our computationed numbers no longer agree with infinite-lattice-assumed theory.  The divergence gets modified by some function of the ratio between the correlation length and our system size,</p>

<script type="math/tex; mode=display">C_h \propto \left( T - T_c \right)^{-\alpha_{\pm}} g\left( \frac{L}{\xi (T)} \right).</script>

<p>Magnetic Susceptibility fulfills the same general role as specific heat, but for magnetization instead of energy.</p>

<script type="math/tex; mode=display">\chi =\frac{d \langle M \rangle}{dT}=\beta^2 \left( \langle M^2 \rangle - \langle M \rangle ^2 \right)</script>

<p>Again, this property also has a corresponding critical exponent.</p>

<script type="math/tex; mode=display">\chi \propto \left( T - T_c \right)^{-\gamma_{\pm}}</script>

<h2 id="exact-solution">Exact Solution</h2>

<p>The 2D Square Ising model possesses an exact solution, first discovered by Lars Onsager in 1944, but since rewritten in a variety of different ways.  I won’t go over how to achieve the solution, but I will show the results for comparison.</p>

<p>The critical temperature:</p>

<script type="math/tex; mode=display">J \beta_c= \frac{\ln \left( \sqrt{2}+1 \right)}{2} \approx .4406</script>

<script type="math/tex; mode=display">T_c \approx 2.269 J</script>

<p>The magnetization curve when $T&lt;T_c$ also $\beta &gt; \beta_c$</p>

<script type="math/tex; mode=display">M=\left(1-\sinh^{-4} \left(2 \beta J \right) \right)^{1/8}</script>

<p>And finally, the much more complicated expression for internal energy per site,</p>

<script type="math/tex; mode=display">k=\sinh (2 \beta J)^{-2}</script>

<script type="math/tex; mode=display">U=-J \coth (2 \beta J) \Bigg(
1 + \frac{2}{\pi} \left( 2 \tanh^2 (2 \beta J) - 1 \right)</script>

<script type="math/tex; mode=display">\;\;\;\;\;\; \int_0^{\pi/2} \frac{1}{\sqrt{1-4k (1+k)^{-2} \sin^2 (\theta)}}
d \theta
\Bigg)</script>

<p>If we can achieve these results to perfect accuracy on pen and paper, why do we even bother simulating them in a computer?  If you try some other lattices and coupling constants, you might soon find out why.  We want to make <i>sure</i> our code is running well on something where we know the results before venturing into unknown territory.</p>

<p>To start off our coding, let’s just type those equations up.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="c"># The critical inverse temperature</span>
<span class="n">betac</span><span class="o">=</span><span class="n">log</span><span class="x">(</span><span class="mi">1</span><span class="o">+</span><span class="n">sqrt</span><span class="x">(</span><span class="mi">2</span><span class="x">))</span><span class="o">/</span><span class="mi">2</span>

<span class="c"># The exact magnetization</span>
<span class="c"># Note: Does not take arrays</span>
<span class="k">function</span><span class="nf"> Mexact</span><span class="x">(</span><span class="n">beta</span><span class="o">::</span><span class="kt">Float64</span><span class="x">)</span>
    <span class="k">if</span> <span class="n">beta</span><span class="o">&gt;</span><span class="n">betac</span>
        <span class="k">return</span> <span class="x">(</span><span class="mi">1</span><span class="o">-</span><span class="n">sinh</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">J</span><span class="x">)</span><span class="o">^</span><span class="x">(</span><span class="o">-</span><span class="mf">4.</span><span class="x">))</span><span class="o">^</span><span class="x">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">8.</span><span class="x">)</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">end</span>
<span class="k">end</span>

<span class="c"># The exact energy</span>
<span class="c"># Note: Does not take arrays</span>
<span class="k">function</span><span class="nf"> Eexact</span><span class="x">(</span><span class="n">beta</span><span class="o">::</span><span class="kt">Float64</span><span class="x">)</span>
    <span class="n">k</span><span class="o">=</span><span class="n">sinh</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">J</span><span class="x">)</span><span class="o">^</span><span class="x">(</span><span class="o">-</span><span class="mf">2.</span><span class="x">)</span>

    <span class="c"># the inside of the integral.  Define a function so we can use quadgk</span>
    <span class="n">insides</span><span class="x">(</span><span class="n">θ</span><span class="x">)</span><span class="o">=</span><span class="x">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="x">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="x">)</span><span class="o">^</span><span class="x">(</span><span class="o">-</span><span class="mi">2</span><span class="x">)</span><span class="o">*</span><span class="n">sin</span><span class="x">(</span><span class="n">θ</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span><span class="o">^</span><span class="x">(</span><span class="o">-.</span><span class="mi">5</span><span class="x">)</span>
    <span class="c">#we run a numerical integration</span>
    <span class="n">integ</span><span class="o">=</span><span class="n">quadgk</span><span class="x">(</span><span class="n">insides</span><span class="x">,</span><span class="mi">0</span><span class="x">,</span><span class="n">π</span><span class="o">/</span><span class="mi">2</span><span class="x">)[</span><span class="mi">1</span><span class="x">]</span>

    <span class="k">return</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">coth</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">J</span><span class="x">)</span><span class="o">*</span><span class="x">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="n">π</span><span class="o">*</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">tanh</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">J</span><span class="x">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="x">)</span><span class="o">*</span><span class="n">integ</span> <span class="x">)</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Load our packages.</p>

<p><code class="highlighter-rouge">Lattices.jl</code> is the same class I used in the previous post.  Well, I got around to updating the Julia syntax.  So mostly the same.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">push!</span><span class="x">(</span><span class="n">LOAD_PATH</span><span class="x">,</span><span class="s">"../Packages"</span><span class="x">)</span>
<span class="n">using</span> <span class="n">Lattices</span><span class="x">;</span>
<span class="n">using</span> <span class="n">PyPlot</span>
</code></pre>
</div>

<p>Here we set up our lattice.</p>

<p>If looking for a mind bender, look at an <code class="highlighter-rouge">"Checkerboard"</code>, with an anti-ferromagnetic coupling constant, like <code class="highlighter-rouge">J=-1</code>.  Otherwise, just stick with a square.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="c">## Define l here</span>
<span class="n">l</span><span class="o">=</span><span class="mi">20</span><span class="x">;</span>

<span class="n">lt</span><span class="o">=</span><span class="n">MakeLattice</span><span class="x">(</span><span class="s">"Square"</span><span class="x">,</span><span class="n">l</span><span class="x">);</span>
<span class="n">S</span><span class="o">=</span><span class="n">ones</span><span class="x">(</span><span class="kt">Int8</span><span class="x">,</span><span class="n">l</span><span class="x">,</span><span class="n">l</span><span class="x">);</span>  <span class="c">#Our spins</span>
<span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="x">(</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">);</span>
</code></pre>
</div>

<p>Same as last time.</p>

<p>These functions calculate properties of our lattice.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="c"># The energy contribution of just one site</span>
<span class="k">function</span><span class="nf"> dE</span><span class="x">(</span><span class="n">i</span><span class="o">::</span><span class="kt">Int</span><span class="x">)</span>
    <span class="n">Eii</span><span class="o">=</span><span class="mi">0</span><span class="x">;</span>
    <span class="k">for</span> <span class="n">j</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">lt</span><span class="o">.</span><span class="n">nnei</span>
        <span class="n">Eii</span><span class="o">+=</span><span class="n">S</span><span class="x">[</span><span class="n">lt</span><span class="o">.</span><span class="n">neigh</span><span class="x">[</span><span class="n">i</span><span class="x">,</span><span class="n">j</span><span class="x">]];</span>
    <span class="k">end</span>
    <span class="n">Eii</span><span class="o">*=-</span><span class="n">J</span><span class="o">*</span><span class="n">S</span><span class="x">[</span><span class="n">i</span><span class="x">];</span>  <span class="c"># we are computing J sz_i sz_j for one i</span>
    <span class="k">return</span> <span class="n">Eii</span><span class="x">;</span>
<span class="k">end</span>
<span class="c"># The energy of the entire lattice</span>
<span class="k">function</span><span class="nf"> E</span><span class="x">()</span>
    <span class="n">Evar</span><span class="o">=</span><span class="mi">0</span><span class="x">;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span>
        <span class="n">Evar</span><span class="o">+=.</span><span class="mi">5</span><span class="o">*</span><span class="n">dE</span><span class="x">(</span><span class="n">k</span><span class="x">);</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="n">Evar</span><span class="x">;</span>
<span class="k">end</span>
<span class="c"># The magnetization of the entire lattice</span>
<span class="k">function</span><span class="nf"> M</span><span class="x">()</span>
    <span class="n">Mvar</span><span class="o">=</span><span class="mi">0</span><span class="x">;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span>
        <span class="n">Mvar</span><span class="o">+=</span><span class="n">S</span><span class="x">[</span><span class="n">k</span><span class="x">];</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="n">Mvar</span><span class="x">;</span>
<span class="k">end</span>
<span class="s">"defined functions"</span>
</code></pre>
</div>

<h3 id="adjustable-parameters">Adjustable Parameters</h3>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">beta0</span><span class="o">=.</span><span class="mi">1</span><span class="x">;</span>
<span class="n">betaf</span><span class="o">=</span><span class="mi">1</span><span class="x">;</span>
<span class="n">dbeta</span><span class="o">=.</span><span class="mi">1</span><span class="x">;</span>

<span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="x">;</span>
<span class="n">t</span><span class="o">=</span><span class="mi">10000</span><span class="x">;</span>
<span class="n">nskip</span><span class="o">=</span><span class="mi">10</span><span class="x">;</span>   <span class="c"># don't measure every sweep= better decorrelation</span>
<span class="s">"Parameters set"</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">nmeas</span><span class="o">=</span><span class="kt">Int64</span><span class="x">(</span><span class="n">t</span><span class="o">/</span><span class="n">nskip</span><span class="x">);</span> <span class="c"># how many times we will measure</span>
<span class="n">betas</span><span class="o">=</span><span class="n">collect</span><span class="x">(</span><span class="n">beta0</span><span class="x">:</span><span class="n">dbeta</span><span class="x">:</span><span class="n">betaf</span><span class="x">)</span>
<span class="s">"done"</span>
</code></pre>
</div>

<p>I took what we ran last time and wrapped it into a function, <code class="highlighter-rouge">MCMCMagnet</code>.  We aren’t looking at spin configurations this time; we only want the final measureables, which get returned at the end.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="k">function</span><span class="nf"> MCMCMagnet</span><span class="x">(</span><span class="n">beta</span><span class="o">::</span><span class="kt">Float64</span><span class="x">)</span>
    <span class="n">tm</span><span class="o">=</span><span class="mi">1</span><span class="x">;</span> <span class="c">#Our measurement time step</span>

    <span class="n">Ma</span><span class="o">=</span><span class="n">Array</span><span class="x">{</span><span class="kt">Int32</span><span class="x">}(</span><span class="n">nmeas</span><span class="x">);</span> <span class="c"># our magnetization measurements</span>
    <span class="n">Ea</span><span class="o">=</span><span class="n">Array</span><span class="x">{</span><span class="kt">Int32</span><span class="x">}(</span><span class="n">nmeas</span><span class="x">);</span> <span class="c"># our energy measurements</span>
    <span class="n">Ma2</span><span class="o">=</span><span class="n">Array</span><span class="x">{</span><span class="kt">Int32</span><span class="x">}(</span><span class="n">nmeas</span><span class="x">);</span> <span class="c"># magnetization squared</span>
    <span class="n">Ea2</span><span class="o">=</span><span class="n">Array</span><span class="x">{</span><span class="kt">Int32</span><span class="x">}(</span><span class="n">nmeas</span><span class="x">);</span> <span class="c"># energy squared</span>

    <span class="k">for</span> <span class="n">ti</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">t</span>
        <span class="k">for</span> <span class="n">j</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">rand</span><span class="x">(</span><span class="mi">1</span><span class="x">:</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">);</span> <span class="c">#Choosing a random site</span>
            <span class="n">de</span><span class="o">=</span><span class="n">dE</span><span class="x">(</span><span class="n">i</span><span class="x">);</span>
            <span class="k">if</span><span class="x">(</span><span class="n">de</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">||</span> <span class="n">rand</span><span class="x">()</span><span class="o">&lt;</span><span class="n">exp</span><span class="x">(</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">de</span><span class="x">)</span> <span class="x">)</span>
                <span class="n">S</span><span class="x">[</span><span class="n">i</span><span class="x">]</span><span class="o">=-</span><span class="n">S</span><span class="x">[</span><span class="n">i</span><span class="x">];</span> <span class="c">#Switch the sign</span>
            <span class="k">end</span>
        <span class="k">end</span>
        <span class="k">if</span> <span class="n">isapprox</span><span class="x">(</span><span class="n">mod</span><span class="x">(</span><span class="n">ti</span><span class="x">,</span><span class="n">nskip</span><span class="x">),</span><span class="mi">0</span><span class="x">)</span>
            <span class="n">Ma</span><span class="x">[</span><span class="n">tm</span><span class="x">]</span><span class="o">=</span><span class="n">M</span><span class="x">();</span>
            <span class="n">Ma2</span><span class="x">[</span><span class="n">tm</span><span class="x">]</span><span class="o">=</span><span class="n">Ma</span><span class="x">[</span><span class="n">tm</span><span class="x">]</span><span class="o">^</span><span class="mi">2</span><span class="x">;</span>

            <span class="n">Ea</span><span class="x">[</span><span class="n">tm</span><span class="x">]</span><span class="o">=</span><span class="n">E</span><span class="x">();</span>
            <span class="n">Ea2</span><span class="x">[</span><span class="n">tm</span><span class="x">]</span><span class="o">=</span><span class="n">Ea</span><span class="x">[</span><span class="n">tm</span><span class="x">]</span><span class="o">^</span><span class="mi">2</span><span class="x">;</span>

            <span class="n">tm</span><span class="o">+=</span><span class="mi">1</span><span class="x">;</span>

        <span class="k">end</span>
    <span class="k">end</span>
    <span class="n">Mave</span><span class="o">=</span><span class="n">mean</span><span class="x">(</span><span class="n">Ma</span><span class="x">);</span>
    <span class="n">Mstd</span><span class="o">=</span><span class="n">std</span><span class="x">(</span><span class="n">Ma</span><span class="x">)</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">;</span>
    <span class="n">Eave</span><span class="o">=</span><span class="n">mean</span><span class="x">(</span><span class="n">Ea</span><span class="x">);</span>
    <span class="n">Estd</span><span class="o">=</span><span class="n">std</span><span class="x">(</span><span class="n">Ea</span><span class="x">)</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">;</span>

    <span class="n">E2ave</span><span class="o">=</span><span class="n">mean</span><span class="x">(</span><span class="n">Ea2</span><span class="x">);</span>
    <span class="n">M2ave</span><span class="o">=</span><span class="n">mean</span><span class="x">(</span><span class="n">Ma2</span><span class="x">);</span>

    <span class="n">Ch</span><span class="o">=</span><span class="n">beta</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="x">(</span><span class="n">E2ave</span><span class="o">-</span><span class="n">Eave</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">;</span>
    <span class="n">χ</span><span class="o">=</span><span class="n">beta</span><span class="o">*</span><span class="x">(</span><span class="n">M2ave</span><span class="o">-</span><span class="n">Mave</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">;</span>

    <span class="k">return</span> <span class="n">Mave</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">,</span><span class="n">Mstd</span><span class="x">,</span><span class="n">Eave</span><span class="o">/</span><span class="n">lt</span><span class="o">.</span><span class="n">N</span><span class="x">,</span><span class="n">Estd</span><span class="x">,</span><span class="n">Ch</span><span class="x">,</span><span class="n">χ</span>
<span class="k">end</span>
</code></pre>
</div>

<h1 id="the-temperature-loop">The Temperature Loop</h1>

<p>This cell looks pretty simple: initialization and one for loop.  But this is where everything ties together.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">Mm</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">betas</span><span class="x">)</span>
<span class="n">Mstd</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">betas</span><span class="x">)</span>
<span class="n">Ee</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">betas</span><span class="x">)</span>
<span class="n">Estd</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">betas</span><span class="x">)</span>
<span class="n">Ch</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">betas</span><span class="x">)</span>
<span class="n">χ</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">betas</span><span class="x">)</span>
<span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">length</span><span class="x">(</span><span class="n">betas</span><span class="x">)</span>
    <span class="n">Mm</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="n">Mstd</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="n">Ee</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="n">Estd</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="n">Ch</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="n">χ</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">MCMCMagnet</span><span class="x">(</span><span class="n">betas</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
    <span class="n">println</span><span class="x">(</span><span class="s">"beta: "</span><span class="x">,</span><span class="n">betas</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="s">"</span><span class="se">\t</span><span class="s">M: "</span><span class="x">,</span><span class="n">Mm</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="s">"</span><span class="se">\t</span><span class="s">E: "</span><span class="x">,</span><span class="n">Ee</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>beta: 0.1	M: 0.00039	E: -0.20528
beta: 0.2	M: 0.003225	E: -0.42512
beta: 0.3	M: 0.001325	E: -0.6998099999999999
beta: 0.4	M: 0.003525	E: -1.11878
beta: 0.5	M: 0.8965900000000001	E: -1.73719
beta: 0.6	M: 0.973875	E: -1.9091300000000002
beta: 0.7	M: 0.989965	E: -1.96268
beta: 0.8	M: 0.996135	E: -1.98525
beta: 0.9	M: 0.99832	E: -1.99347
beta: 1.0	M: 0.99934	E: -1.99739
</code></pre>
</div>

<p>That was the temperature loop for the MCMC method.</p>

<p>This is the temperature loop to calculate the exact numbers.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">Mex</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">betas</span><span class="x">)</span>
<span class="n">Eex</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">betas</span><span class="x">)</span>
<span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">length</span><span class="x">(</span><span class="n">betas</span><span class="x">)</span>
    <span class="n">Mex</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">Mexact</span><span class="x">(</span><span class="n">betas</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
    <span class="n">Eex</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">Eexact</span><span class="x">(</span><span class="n">betas</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
<span class="k">end</span>
</code></pre>
</div>

<h3 id="storing-and-restoring-data">Storing and Restoring Data</h3>

<p>Since running these simulations take slightly longer than some of my previous posts, I’ve outputed data files of the results of three different sizes lattices (l=10, l=20, l=50), for runs of length 50,000.  All have the same <code class="highlighter-rouge">betas</code> variable. Feel free to take a look at them, or make your own data :)</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="c">#writedlm("PhaseTransitionsL20T50000.dat",[betas Mm Mstd Ee Estd Ch χ])</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">temp</span><span class="o">=</span><span class="n">readdlm</span><span class="x">(</span><span class="s">"PhaseTransitionsL50T50000.dat"</span><span class="x">)</span>
<span class="n">betas</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">1</span><span class="x">];</span>
<span class="n">Mm50</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">2</span><span class="x">];</span>
<span class="n">Mstd50</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">3</span><span class="x">];</span>
<span class="n">Ee50</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">4</span><span class="x">];</span>
<span class="n">Estd50</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">5</span><span class="x">];</span>
<span class="n">Ch50</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">6</span><span class="x">];</span>
<span class="n">χ50</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">7</span><span class="x">];</span>

<span class="n">temp</span><span class="o">=</span><span class="n">readdlm</span><span class="x">(</span><span class="s">"PhaseTransitionsL10T50000.dat"</span><span class="x">)</span>
<span class="n">Mm10</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">2</span><span class="x">];</span>
<span class="n">Mstd10</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">3</span><span class="x">];</span>
<span class="n">Ee10</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">4</span><span class="x">];</span>
<span class="n">Estd10</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">5</span><span class="x">];</span>
<span class="n">Ch10</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">6</span><span class="x">];</span>
<span class="n">χ10</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">7</span><span class="x">];</span>

<span class="n">temp</span><span class="o">=</span><span class="n">readdlm</span><span class="x">(</span><span class="s">"PhaseTransitionsL20T50000.dat"</span><span class="x">)</span>
<span class="n">Mm20</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">2</span><span class="x">];</span>
<span class="n">Mstd20</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">3</span><span class="x">];</span>
<span class="n">Ee20</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">4</span><span class="x">];</span>
<span class="n">Estd20</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">5</span><span class="x">];</span>
<span class="n">Ch20</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">6</span><span class="x">];</span>
<span class="n">χ20</span><span class="o">=</span><span class="n">temp</span><span class="x">[:,</span><span class="mi">7</span><span class="x">];</span>
</code></pre>
</div>

<h1 id="plotting-section">Plotting Section</h1>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">Mex</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Exact"</span><span class="x">,</span><span class="n">linewidth</span><span class="o">=</span><span class="s">"5"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">abs</span><span class="x">(</span><span class="n">Mm10</span><span class="x">),</span><span class="n">label</span><span class="o">=</span><span class="s">"l=10"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">abs</span><span class="x">(</span><span class="n">Mm20</span><span class="x">),</span><span class="n">label</span><span class="o">=</span><span class="s">"l=20"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">abs</span><span class="x">(</span><span class="n">Mm50</span><span class="x">),</span><span class="n">label</span><span class="o">=</span><span class="s">"l=50"</span><span class="x">)</span>

<span class="n">xlabel</span><span class="x">(</span><span class="s">"Inverse Temperature β"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Magnetization"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">()</span>
<span class="n">title</span><span class="x">(</span><span class="s">"2D Square Ferromagnet Phase Transition"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/PhaseTransitions/output_23_0.png" alt="Magnetization" />
    
    
        <p class="image-caption">The order parameter magnetization jumps at the critical temperature $\beta_c\approx.44$.</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">Eex</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Exact"</span><span class="x">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">Ee10</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"l=10"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">Ee20</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"l=20"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">Ee50</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"l=50"</span><span class="x">)</span>
<span class="n">xlabel</span><span class="x">(</span><span class="s">"Inverse Temperature β"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Magnetization"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">()</span>
<span class="n">title</span><span class="x">(</span><span class="s">"2D Square Ferromagnet Phase Transition"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/PhaseTransitions/output_24_0.png" alt="Energy" />
    
    
        <p class="image-caption">The Energy curve for a variety of sizes and the exact infinite lattice.</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">Ch10</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"l=10"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">Ch20</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"l=20"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">Ch50</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"l=50"</span><span class="x">)</span>
<span class="n">xlabel</span><span class="x">(</span><span class="s">"Inverse Temperature β"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Specific Heat"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">()</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Specific Heat Divergence with Finite Size Scaling"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/PhaseTransitions/output_25_0.png" alt="Specific Heat" />
    
    
        <p class="image-caption">The specific heat diverges around the critical temperature, but a finite simulation lattice prevents a true divergence from occurring.  The larger the lattice, the more the specific heat diverges.</p>
    
</div>

<p>I presented two different equivalent formulas for the specific heat.  Let’s check to make sure their equivalent.</p>

<p>For the formal defination, we’ll take a numeric derivative with respect to $\beta$,
\begin{equation}
\frac{d \langle E \rangle}{dT} \approx \frac{ \Delta \langle E \rangle}{\Delta \beta}\frac{d \beta}{d T}
\end{equation}</p>

<p>Note: I corrected the scaling by hand.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">Ch2</span><span class="o">=</span><span class="x">(</span><span class="n">Ee50</span><span class="x">[</span><span class="mi">1</span><span class="x">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">-</span><span class="n">Ee50</span><span class="x">[</span><span class="mi">2</span><span class="x">:</span><span class="k">end</span><span class="x">])</span><span class="o">.*</span><span class="n">betas</span><span class="x">[</span><span class="mi">2</span><span class="x">:</span><span class="k">end</span><span class="x">]</span><span class="o">.^</span><span class="mi">2</span>

<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">[</span><span class="mi">2</span><span class="x">:</span><span class="k">end</span><span class="x">],</span><span class="n">Ch2</span><span class="o">*</span><span class="mi">35</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"dE/dT"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">Ch50</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"beta2(&lt;E2&gt;-&lt;E&gt;2)"</span><span class="x">)</span>
<span class="n">xlabel</span><span class="x">(</span><span class="s">"Temperature"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Specific Heat"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">()</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Comparing Specific Heat Calculations"</span><span class="x">)</span>

</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/PhaseTransitions/output_27_0.png" alt="Specific Heat Calculations" />
    
    
        <p class="image-caption">Both the derivative formula and the expectation value formula for the specific heat give the same result, after correcting for a scaling factor.</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">χ10</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"l=10"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">χ20</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"l=20"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">χ50</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"l=50"</span><span class="x">)</span>
<span class="n">xlabel</span><span class="x">(</span><span class="s">"Inverse Temperature β"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Susceptibility"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">()</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Magnetic Susceptibility with Finite Size Scaling"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/PhaseTransitions/output_28_0.png" alt="Magnetic Susceptibility" />
    
    
        <p class="image-caption">The magnetic susceptibility, unlike specific heat, is not symmetric around the critical temperature.  The apparent value for critical temperature also changes with system size, approaching the infinite lattice value.</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">M2</span><span class="o">=</span><span class="x">(</span><span class="n">Mm50</span><span class="x">[</span><span class="mi">1</span><span class="x">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">-</span><span class="n">Mm50</span><span class="x">[</span><span class="mi">2</span><span class="x">:</span><span class="k">end</span><span class="x">])</span><span class="o">.*</span><span class="x">(</span><span class="n">betas</span><span class="x">[</span><span class="mi">1</span><span class="x">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="x">])</span><span class="o">.^</span><span class="mi">2</span>
<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">[</span><span class="mi">1</span><span class="x">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="x">],</span><span class="n">M2</span><span class="o">*</span><span class="mi">750</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"dM/dT"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">betas</span><span class="x">,</span><span class="n">χ50</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"(&lt;M2&gt;-&lt;M&gt;2)beta2"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">()</span>
<span class="n">xlabel</span><span class="x">(</span><span class="s">"Inverse Temperature β"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Specific Heat"</span><span class="x">)</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Comparing Methods of Computing Susceptibility"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/PhaseTransitions/output_29_0.png" alt="Magnetic Susceptibility Methods" />
    
    
        <p class="image-caption">Both the derivative method and the expectation value method give approximately the value for the susceptibility.</p>
    
</div>

<p>That’s all for now.  Plenty more to talk about on this subject, but hopefully that can keep you occupied.</p>

  </article>

</div>

      </div>
    </div>

    <div class="comment">
<!-- Add Disqus comments. -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'M4julia'; // required: replace example with your forum shortname
  var disqus_identifier = "/Phase-Transitions.html";

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>

    <footer class="site-footer">
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>


  <div class="wrapper">

    <h2 class="footer-heading">Metals, Magnets, and Miscellaneous Materials</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Metals, Magnets, and Miscellaneous Materials</li>
          <li><a href="mailto:chrissie.c.l@gmail.com">chrissie.c.l@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/albi3ro">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">albi3ro</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/PyrochloreLee">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">PyrochloreLee</span>
            </a>
          </li>
          
          <li>
              <div class="fb-share-button"
               data-href="/M4/Phase-Transitions.html" data-layout="button_count"></div>

          </li>
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Blog Introduction to Computational Condensed Matter Physics</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-70984222-1', 'auto');
  ga('send', 'pageview');

</script>
