<!DOCTYPE html>
<html>


  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Intro to Jupyter and Projectile Motion</title>
    <!-- <meta name="description" content="Blog Introduction to Computational Condensed Matter Physics"> -->
    <link rel="stylesheet" href="/M4/css/main.css">
    <link rel="canonical" href="http://localhost:4000/M4/Projectile-Motion.html">
    <meta name="google-site-verification" content="FLWeXTRDBUYGSJXcdiUyqbwExBElCj76l3EdhtLL-wI" />
          <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [ ['$','$'], ['\(', '\)'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true,
    }
  });
</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


    <meta property="og:title" content="Intro to Jupyter and Projectile Motion" />
    <meta property="og:image" content="https://albi3ro.github.io/M4/Images/Projectile/spaceship.png" />
    <meta property="twitter:card" content="summary" />
    <meta property="twitter:site" content="@PyrochloreLee" />
    <meta property="twitter:title" content="Intro to Jupyter and Projectile Motion" />
    <meta property="twitter:image" content="https://albi3ro.github.io/M4/Images/Projectile/spaceship.png" />
    <meta property="twitter:description" content="A STEM high school introduction to Jupyter notebooks, numerics, and Julia through projectile motion." />

    <link rel="apple-touch-icon" sizes="180x180" href="/M4/Images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/M4/Images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/M4/Images/favicons/favicon-16x16.png">
    <link rel="manifest" href="/M4/Images/favicons/manifest.json">
    <link rel="mask-icon" href="/M4/Images/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="theme-color" content="#000000">

</head>


  <body>


    <header class="site-header">

  <div>

    <a class="site-title" href="/M4/">Metals, Magnets, and Miscellaneous Materials</a>

    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top" style="float: right">
    <input type="hidden" name="cmd" value="_donations">
    <input type="hidden" name="business" value="chrissie.c.l@gmail.com">
    <input type="hidden" name="lc" value="US">
    <input type="hidden" name="item_name" value="M4">
    <input type="hidden" name="no_note" value="0">
    <input type="hidden" name="currency_code" value="USD">
    <input type="hidden" name="bn" value="PP-DonationsBF:btn_donate_SM.gif:NonHostedGuest">
    <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
    <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
    </form>



  </div>

</header>




    <div class="page-content">
        <div class="downloadzp"><a href="https://github.com/albi3ro/M4/archive/master.zip" class="sidebar">Zip!</a></div>

        <div class="clonelink"><a href="https://github.com/albi3ro/M4.git" class="sidebar">Clone!</a></div>

        <div class="pdfslink"><a href="/M4/pdfs" class="sidebar">PDFs</a></div>

        <div class="juliadocs"><a href="https://docs.julialang.org/" class="sidebar">Docs</a></div>

        <div class="juliahelp"><a href="/M4/jupyterjulia" class="sidebar">Interact</a></div>

        <div class="about"><a href="/M4/about" class="sidebar">About</a></div>

      <div class="wrapper">
        <div class="post">
<meta name="description" content="A STEM high school introduction to Jupyter notebooks, numerics, and Julia through projectile motion." />
<meta name="keywords" content="Intro" />
<meta name="author" content="Christina C. Lee" />

  <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

  <header class="post-header">
    <h1 class="post-title" itemprop="name">Intro to Jupyter and Projectile Motion</h1>
    <p class="post-meta">Author: Christina C. Lee &nbsp;&nbsp;&nbsp;&nbsp;
      Category: <a href="/M4/categories#General Audience">
        General Audience</a> &nbsp;  &nbsp; &nbsp; &nbsp;
        Tags:
      
      <a href="/M4/tags#Intro">Intro</a>&nbsp; 
        
        &nbsp;  &nbsp; &nbsp; &nbsp;
      Series: <a href="/M4/series#"></a>
      </p>
  </header>

  <article class="post-content">

    <p>I wrote this piece as part of a presentation I gave to the robotics team at Benson High School in Portland, OR.  My thanks to my mentor John Delacy for working with me in high school and fostering my love for science and astronomy, and for inviting me to help work with the next generation of scientists and engineers.  I loved getting to see their robots and hear about the competitions.</p>

<h1 id="intro-to-jupyter-notebooks">Intro to Jupyter Notebooks</h1>

<p>Currently we are using a jupyter notebook.  This format can support either Julia, Python, or R.  The format is quite similiar to that used in the propriety software Mathematica.</p>

<p>We have two types of cells:</p>
<ul>
  <li>Markdown cells</li>
  <li>Code Cells</li>
</ul>

<h3 id="markdown-cells">Markdown Cells</h3>

<p>This is a <b>Markdown Cell</b>.  Here we write text or add pictures to describe what we are doing.  In raw format, everything is easily readable, but the computer can also render it to look even nicer with headings, lists,<b>bold</b>,<i>italic</i>, tables, links, and other formatting.</p>

<p>I can even write equations.</p>

<script type="math/tex; mode=display">x_0 = \frac{-b \pm \sqrt{b^2 - 4 a c}}{2a}</script>

<p>Equations use LaTeX syntax.  LaTeX is a document preparation language used by those in STEM.  It’s how we make all those awesome looking papers.  It also automatically handles our citations for us :)  Check out <a href="https://www.overleaf.com/">Overleaf</a> to create documents online.</p>

<p>I can also write code inline <code class="highlighter-rouge">x+=1</code> or in block style</p>

<div class="highlighter-rouge"><pre class="highlight"><code>for ii in 1:n
    x+=1
end
</code></pre>
</div>

<h3 id="coding-cells">Coding Cells</h3>

<p>You can evaluate coding cells by pushing <b>Shift-Enter</b>.</p>

<p>Next to Coding Cells, <code class="highlighter-rouge">In[ ]</code> specifies the code that will be executed, and <code class="highlighter-rouge">Out[]</code> specifies the output of the given cell.  The number specifies the order in which the code got evaluated.</p>

<p><b>Important</b>: Global variables get edited each time you evaluate a new cell.  So order of evaluation matters.</p>

<h3 id="julias-packages">Julia’s Packages</h3>

<p>Julia uses external packages, much like Python, to supplement its core functionality.  <b>PyPlot</b> imports plotting functionality from Python’s PyPlot with the package PyCall.  <a href="http://pkg.julialang.org/">Julia</a> maintains a complete list of supported external packages.  While many are quite specialized or out of date, some are incredibly useful, like different plotting tools, curve fitting, integrators, differential equations, accelerators, working with different file types, and more.</p>

<p>If you need to run a jupyter notebook on your machine instead of on JuliaBox, you would be using the IJulia package.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="c"># Update packages</span>
<span class="n">Pkg</span><span class="o">.</span><span class="n">update</span><span class="x">()</span>

<span class="c"># Add a new package to your repository</span>
<span class="c"># Unnecessary if already added</span>
<span class="c">#Pkg.add("PyPlot")</span>

<span class="c"># Load PyPlot into</span>
<span class="n">using</span> <span class="n">PyPlot</span>
</code></pre>
</div>

<h1 id="projectile-motion">Projectile Motion</h1>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/spaceship.svg" alt="Spaceship" />
    
    
        <p class="image-caption">An example of a projectile.</p>
    
</div>

<script type="math/tex; mode=display">\text{distance}= \text{rate}\times\text{time}\;\;\;\; \implies \;\;\;\;\;
x(t) = v_x t</script>

<p>BUT</p>

<script type="math/tex; mode=display">y(t) = v_y (t) t \;\;\;\;\;\text{?}</script>

<p>NO! How do we solve this?</p>

<p>First let’s write down the infinitesimal, exact version of the equations.  Sorry if you haven’t had Calculus yet.  Just block out this part and keep going.</p>

<script type="math/tex; mode=display">\frac{d x}{dt} = v_x \;\;\; \frac{dy}{dt} = v_y</script>

<script type="math/tex; mode=display">\frac{d v_x}{dt} = 0 \;\;\;\; \frac{d v_y}{dt}= g</script>

<p>In order to put this into an equation, we take the derivative and break it into a courser grained version</p>

<script type="math/tex; mode=display">\frac{dx}{dt} \approx \frac{ \Delta x}{\Delta t}.</script>

<p>Now because $\Delta x$ and $\Delta t$ have actual sizes instead of being infinitesimally small, the computer can deal with them.</p>

<p>Now we take lots of baby steps of $\Delta t$ over our time interval to change the position with the changing velocity.</p>

<script type="math/tex; mode=display">y(t_{n+1})= y(t_n)+ v_y(t_n) \Delta t</script>

<p>We can also think of this as finding a small enough interval such that we can treat the y velocity as if it’s constant.</p>

<p>Bonus note:  Different types of algorithms,like symplectic, evaluate the velocity at different time points.</p>

<h3 id="a-cell-of-parameters-we-need-to-enter">A cell of parameters we need to enter</h3>

<p>This first cell is parameters that we need to decided upon.  I’ve put in numbers that are fairly resonable and tested.</p>

<p>You can change the value of them and see what happens to the final answer.  Hopefully nothing will break ;)</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">θ</span><span class="o">=</span><span class="n">π</span><span class="o">/</span><span class="mi">4</span> <span class="c">#angle with respect to horizontal</span>
<span class="n">v0</span><span class="o">=</span><span class="mi">10</span> <span class="c"># intial velocity</span>

<span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="x">;</span> <span class="c"># initial position</span>
<span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="x">;</span>

<span class="n">t0</span><span class="o">=</span><span class="mi">0</span> <span class="c">#initial time</span>
<span class="n">tf</span><span class="o">=</span><span class="mi">2</span> <span class="c">#final time</span>
<span class="n">dt</span><span class="o">=</span><span class="mf">1e-3</span> <span class="c">#time step size</span>
</code></pre>
</div>

<h3 id="preliminary-calculation-of-important-variables">Preliminary calculation of important variables</h3>

<p>This is again more parameters, but this cell shouldn’t be changed.</p>

<p>Unless you want to go to the moon or Mars…</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">g</span><span class="o">=</span><span class="mf">9.8</span> <span class="c">#m/s^2</span>

<span class="n">vx0</span><span class="o">=</span><span class="n">v0</span><span class="o">*</span><span class="n">cos</span><span class="x">(</span><span class="n">θ</span><span class="x">)</span> <span class="c"># x component of velocity at initial time step</span>
<span class="n">vy0</span><span class="o">=</span><span class="n">v0</span><span class="o">*</span><span class="n">sin</span><span class="x">(</span><span class="n">θ</span><span class="x">)</span> <span class="c"># y component of velocity at initial time step</span>

<span class="n">t</span><span class="o">=</span><span class="n">collect</span><span class="x">(</span><span class="n">t0</span><span class="x">:</span><span class="n">dt</span><span class="x">:</span><span class="n">tf</span><span class="x">)</span> <span class="c"># creates an array that holds each time point</span>
<span class="n">nt</span><span class="o">=</span><span class="n">length</span><span class="x">(</span><span class="n">t</span><span class="x">)</span> <span class="c">#the number of time steps we willl have</span>
</code></pre>
</div>

<h3 id="initialization-of-variables">Initialization of Variables</h3>

<p>As we march along for a bunch of time steps, we will be computing our position and velocity, but we will need some place to put those numbers.  It’s more efficient and better practice to create a place to put those numbers beforehand.  So that’s what we are doing here.</p>

<p>We are also setting the first value in the position/ velocity vectors to be their initial values.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="c">#initializing empty vectors that will hold position and velocity at each time step</span>
<span class="n">x</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">t</span><span class="x">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">t</span><span class="x">)</span>
<span class="n">vx</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">t</span><span class="x">)</span>
<span class="n">vy</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">t</span><span class="x">)</span>

<span class="n">x</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">=</span><span class="n">x0</span>
<span class="n">y</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">=</span><span class="n">y0</span>
<span class="n">vx</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">=</span><span class="n">vx0</span>
<span class="n">vy</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">=</span><span class="n">vy0</span>
</code></pre>
</div>

<h3 id="loop-of-time-steps">Loop of Time Steps</h3>

<p>Now we do our actual calculation.  We march along, taking tiny little baby steps, calculating our new positions and our new velocities and storing them in our vectors.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">2</span><span class="x">:</span><span class="n">nt</span>
    <span class="n">x</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">x</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">+</span><span class="n">vx</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">+</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">*</span><span class="n">dt</span>

    <span class="n">vx</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">vx</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span>
    <span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="n">dt</span>
<span class="k">end</span>
</code></pre>
</div>

<h2 id="plotting">Plotting</h2>

<p>We use <a href="https://matplotlib.org/users/pyplot_tutorial.html">PyPlot</a> to display our results here.  It’s imported into Julia from Python and has great documentation and versitility.</p>

<div class="progtip">
<h3 color="black">Tips from Expierence</h3><p>Always include x and y labels, title, legends, and relevant units <b>on the graph</b>.  </p>

<p>The graph might seem obvious to you now, but the labeling might not seem obvious to you next week, next month, or next year.  And it probably won't seem obvious to someone else looking at your work. So I'll be taking a few extra lines to make sure I include all that.</p></div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">x</span><span class="x">,</span><span class="n">y</span><span class="x">)</span>

<span class="n">xlabel</span><span class="x">(</span><span class="s">"x"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"y"</span><span class="x">)</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Simple Projectile Motion"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_14_0.png" alt="Simple Projectile Motion" />
    
    
        <p class="image-caption">Simple Projectile Motion.</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">yexact</span><span class="o">=-</span><span class="n">g</span><span class="o">/</span><span class="mf">2.</span><span class="o">*</span><span class="n">t</span><span class="o">.^</span><span class="mf">2.</span><span class="o">+</span><span class="n">vy0</span><span class="o">.*</span><span class="n">t</span>

<span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">y</span><span class="x">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">6</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Numerical"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">yexact</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Exact"</span><span class="x">)</span>

<span class="n">xlabel</span><span class="x">(</span><span class="s">"t"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"y"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">()</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Comparing Numerical and Exact Calculations"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_15_0.png" alt="Comparison" />
    
    
        <p class="image-caption">Comparing Numerical and Exact Calculations</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">yexact</span><span class="o">-</span><span class="n">y</span><span class="x">)</span>

<span class="n">xlabel</span><span class="x">(</span><span class="s">"t"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Y Error"</span><span class="x">)</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Error over time of Numerical solution at dt= </span><span class="si">$</span><span class="s">dt"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_16_0.png" alt="Error Evolution" />
    
    
        <p class="image-caption">Error over time of Numerical Solution</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">vy</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"vy"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">vx</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"vx"</span><span class="x">)</span>

<span class="n">xlabel</span><span class="x">(</span><span class="s">"t"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"velocity"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">()</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Velocities over time"</span><span class="x">)</span>

</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_17_0.png" alt="Velocity Evolution" />
    
    
        <p class="image-caption">Velocity Evolution.  Notice how the x velocity remains constant while the y velocity accelerates.</p>
    
</div>

<h2 id="but-what-if-there-is-a-surface">But what if there is a surface?</h2>

<p>If we place a surface at $y=0$, or any other location, the ball won’t just keep on falling forever.  We can choose two types of actions when it encounters the surface</p>

<ul>
  <li><b>Elastic Collision:</b> The ball bounces with the same amount of kinetic energy, just in the opposite direction</li>
  <li><b>Inelastic Collision:</b> The ball looses a fraction of its energy in the collision.
    <ul>
      <li>At an extreme of this case, the ball looses all its energy.</li>
    </ul>
  </li>
</ul>

<p>We use an <code class="highlighter-rouge">if</code> statement to determine when it encounters the surface.  We’ll just do an elastic collision, so we can just change $v_y$ and not have to worry about total energy, etc.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">2</span><span class="x">:</span><span class="n">nt</span>
    <span class="n">x</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">x</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">+</span><span class="n">vx</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">+</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">*</span><span class="n">dt</span>

    <span class="k">if</span> <span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">&lt;</span><span class="mi">0</span>
        <span class="n">println</span><span class="x">(</span><span class="s">"Hit the surface at t: "</span><span class="x">,</span><span class="n">t</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="s">"</span><span class="se">\t</span><span class="s"> x: "</span><span class="x">,</span><span class="n">x</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
        <span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">=-</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span>
        <span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">+</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">*</span><span class="n">dt</span>
    <span class="k">end</span>

    <span class="n">vx</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">vx</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span>
    <span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="n">dt</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Hit the surface at t: 1.445	 x: 10.217692988145673
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">x</span><span class="x">,</span><span class="n">y</span><span class="x">)</span>

<span class="n">xlabel</span><span class="x">(</span><span class="s">"x"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"y"</span><span class="x">)</span>

<span class="n">title</span><span class="x">(</span><span class="s">"Projectile Motion with a Surface"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_20_0.png" alt="Projectile with Surface" />
    
    
        <p class="image-caption">Projectile with surface.  Notice it bounce at x=10.2</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">vy</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"vy"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">vx</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"vx"</span><span class="x">)</span>

<span class="n">xlabel</span><span class="x">(</span><span class="s">"t"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"velocity"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">()</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Velocity over time with bounce"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_21_0.png" alt="Velocity with Bounce" />
    
    
        <p class="image-caption">Velocity with Bounce.  At t=1.445, the y velocity switches to positive.</p>
    
</div>

<h2 id="why-do-we-do-analytics-at-all">Why do we do analytics at all?</h2>

<p>So we just found our intercepts and made a bunch of nice graphs without ever having to do any algebra.  Why do we force you to slog through it?</p>

<p>Because you need to know what to expect to know when it’s completely going wrong or when something might fail numerically.</p>

<p>This problem is pretty robust, but if you try other problems like the Van der Pol problem, or one’s that display any instability or chaos, we would really need to callibrate to the right time step size.  More specialized algorithms, like the ones I talk about in my ODE post, also allow you more accuracy for larger step sizes.</p>

<p>Let’s do the same things but for a range of different time steps to show some of the limitations of numerical analysis.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="c"># Lets choose our step sizes</span>
<span class="n">dta</span><span class="o">=</span><span class="x">[</span><span class="o">.</span><span class="mi">001</span><span class="x">,</span><span class="o">.</span><span class="mi">01</span><span class="x">,</span><span class="o">.</span><span class="mi">1</span><span class="x">,</span><span class="o">.</span><span class="mi">2</span><span class="x">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>4-element Array{Float64,1}:
 0.001
 0.01
 0.1
 0.2
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="c"># The length of each time series</span>
<span class="c"># All arrays will be the same length, but some will be padded</span>
<span class="n">na</span><span class="o">=</span><span class="n">floor</span><span class="x">(</span><span class="kt">Int</span><span class="x">,(</span><span class="n">tf</span><span class="o">-</span><span class="n">t0</span><span class="x">)</span><span class="o">./</span><span class="n">dta</span><span class="x">)</span>

<span class="c"># The place holding arrays</span>
<span class="n">ta</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="kt">Float64</span><span class="x">,</span><span class="n">maximum</span><span class="x">(</span><span class="n">na</span><span class="x">),</span><span class="n">length</span><span class="x">(</span><span class="n">dta</span><span class="x">))</span>
<span class="n">xa</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">ta</span><span class="x">)</span>
<span class="n">ya</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">ta</span><span class="x">)</span>
<span class="n">vxa</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">ta</span><span class="x">)</span>
<span class="n">vya</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">ta</span><span class="x">)</span>

<span class="c"># Where we start</span>
<span class="n">xa</span><span class="x">[</span><span class="mi">1</span><span class="x">,:]</span><span class="o">=</span><span class="n">x0</span>
<span class="n">ya</span><span class="x">[</span><span class="mi">1</span><span class="x">,:]</span><span class="o">=</span><span class="n">y0</span>
<span class="n">vxa</span><span class="x">[</span><span class="mi">1</span><span class="x">,:]</span><span class="o">=</span><span class="n">vx0</span>
<span class="n">vya</span><span class="x">[</span><span class="mi">1</span><span class="x">,:]</span><span class="o">=</span><span class="n">vy0</span>

<span class="c"># We perform one loop for each step size</span>
<span class="k">for</span> <span class="n">jj</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">length</span><span class="x">(</span><span class="n">dta</span><span class="x">)</span>

    <span class="c"># This is the step size for the loop</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">dta</span><span class="x">[</span><span class="n">jj</span><span class="x">]</span>
    <span class="c"># We only use the first na[jj] of the arrays</span>
    <span class="n">ta</span><span class="x">[</span><span class="mi">1</span><span class="x">:</span><span class="n">na</span><span class="x">[</span><span class="n">jj</span><span class="x">],</span><span class="n">jj</span><span class="x">]</span><span class="o">=</span><span class="n">linspace</span><span class="x">(</span><span class="n">t0</span><span class="x">,</span><span class="n">tf</span><span class="x">,</span><span class="n">na</span><span class="x">[</span><span class="n">jj</span><span class="x">])</span>

    <span class="c">#The same loop we had before</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">2</span><span class="x">:</span><span class="n">na</span><span class="x">[</span><span class="n">jj</span><span class="x">]</span>
        <span class="n">xa</span><span class="x">[</span><span class="n">ii</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">=</span><span class="n">xa</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">+</span><span class="n">vxa</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">*</span><span class="n">dt</span>
        <span class="n">ya</span><span class="x">[</span><span class="n">ii</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">=</span><span class="n">ya</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">+</span><span class="n">vya</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">*</span><span class="n">dt</span>

        <span class="k">if</span> <span class="n">ya</span><span class="x">[</span><span class="n">ii</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">&lt;</span><span class="mi">0</span>
            <span class="n">vya</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">=-</span><span class="n">vya</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span>
            <span class="n">ya</span><span class="x">[</span><span class="n">ii</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">=</span><span class="n">ya</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">+</span><span class="n">vya</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">*</span><span class="n">dt</span>
        <span class="k">end</span>

        <span class="n">vxa</span><span class="x">[</span><span class="n">ii</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">=</span><span class="n">vxa</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span>
        <span class="n">vya</span><span class="x">[</span><span class="n">ii</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">=</span><span class="n">vya</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="n">jj</span><span class="x">]</span><span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="n">dt</span>
    <span class="k">end</span>

<span class="k">end</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">length</span><span class="x">(</span><span class="n">dta</span><span class="x">)</span>
    <span class="n">plot</span><span class="x">(</span><span class="n">xa</span><span class="x">[</span><span class="mi">1</span><span class="x">:</span><span class="n">na</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="n">ii</span><span class="x">],</span><span class="n">ya</span><span class="x">[</span><span class="mi">1</span><span class="x">:</span><span class="n">na</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="n">ii</span><span class="x">],</span><span class="n">label</span><span class="o">=</span><span class="n">dta</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
<span class="k">end</span>

<span class="n">xlabel</span><span class="x">(</span><span class="s">"x"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"y"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">()</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Projectile Motions for different time step sizes"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_25_0.png" alt="Error Analysis" />
    
    
        <p class="image-caption">Projectile Approximations for different step sizes.  As we take larger step sizes, our approximations get successively worse.</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">yexact</span><span class="o">=-</span><span class="n">g</span><span class="o">/</span><span class="mf">2.</span><span class="o">*</span><span class="n">ta</span><span class="o">.^</span><span class="mf">2.</span><span class="o">+</span><span class="n">vy0</span><span class="o">.*</span><span class="n">ta</span>
<span class="n">yerr</span><span class="o">=</span><span class="n">ya</span><span class="o">-</span><span class="n">yexact</span>
<span class="n">ylim</span><span class="x">(</span><span class="o">-.</span><span class="mi">5</span><span class="x">,</span><span class="mi">4</span><span class="x">)</span>

<span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">1</span><span class="x">:</span><span class="n">length</span><span class="x">(</span><span class="n">dta</span><span class="x">)</span>
    <span class="n">plot</span><span class="x">(</span><span class="n">ta</span><span class="x">[</span><span class="mi">1</span><span class="x">:</span><span class="n">na</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="n">ii</span><span class="x">],</span><span class="n">yerr</span><span class="x">[</span><span class="mi">1</span><span class="x">:</span><span class="n">na</span><span class="x">[</span><span class="n">ii</span><span class="x">],</span><span class="n">ii</span><span class="x">],</span><span class="n">label</span><span class="o">=</span><span class="n">dta</span><span class="x">[</span><span class="n">ii</span><span class="x">])</span>
<span class="k">end</span>

<span class="n">annotate</span><span class="x">(</span><span class="s">"The Bounce"</span><span class="x">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="x">[</span><span class="mf">1.5</span><span class="x">,</span> <span class="mf">1.4</span> <span class="x">],</span>
    <span class="n">xytext</span><span class="o">=</span><span class="x">[</span><span class="o">.</span><span class="mi">5</span><span class="x">,</span> <span class="mf">1.5</span><span class="x">],</span>
   <span class="n">xycoords</span><span class="o">=</span><span class="s">"data"</span><span class="x">,</span>
   <span class="n">arrowprops</span><span class="o">=</span><span class="n">Dict</span><span class="x">(</span><span class="s">"facecolor"</span><span class="o">=&gt;</span><span class="s">"green"</span><span class="x">))</span>

<span class="n">xlabel</span><span class="x">(</span><span class="s">"time"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"y error"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">()</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Error in y position for different time step sizes"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_26_0.png" alt="Error Analysis" />
    
    
        <p class="image-caption">Error from the exact solution for each of our approximations.  The exact equation doesn't have a bounce, so we just take the error up to that point.   </p>
    
</div>

<h2 id="but-what-about-air-resistence">But what about Air Resistence?</h2>

<p>Real objects encounter air resistence proportional to velocity.  This can’t be solved analytically, but our code can handle it really easily.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">R</span><span class="o">=.</span><span class="mi">01</span>
<span class="n">dt</span><span class="o">=</span><span class="mf">1e-3</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">t</span><span class="o">=</span><span class="n">collect</span><span class="x">(</span><span class="n">t0</span><span class="x">:</span><span class="n">dt</span><span class="x">:</span><span class="n">tf</span><span class="x">)</span> <span class="c"># creates an array that holds each time point</span>
<span class="n">nt</span><span class="o">=</span><span class="n">length</span><span class="x">(</span><span class="n">t</span><span class="x">)</span> <span class="c">#the number of time steps we willl have</span>

<span class="c">#initializing empty vectors that will hold position and velocity at each time step</span>
<span class="n">x</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">t</span><span class="x">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">t</span><span class="x">)</span>
<span class="n">vx</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">t</span><span class="x">)</span>
<span class="n">vy</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">t</span><span class="x">)</span>

<span class="n">x</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">=</span><span class="n">x0</span>
<span class="n">y</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">=</span><span class="n">y0</span>
<span class="n">vx</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">=</span><span class="n">vx0</span>
<span class="n">vy</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">=</span><span class="n">vy0</span>

<span class="n">E</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">t</span><span class="x">)</span>
<span class="n">E</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">=.</span><span class="mi">5</span><span class="o">*</span><span class="x">(</span><span class="n">vx0</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">vy0</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">2</span><span class="x">:</span><span class="n">nt</span>
    <span class="n">x</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">x</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">+</span><span class="n">vx</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">+</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">*</span><span class="n">dt</span>

     <span class="k">if</span> <span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">&lt;</span><span class="mi">0</span>
        <span class="c">#println("Hit the surface at t: ",t[ii],"\t x: ",x[ii])</span>
        <span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">=-</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span>
        <span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">+</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">*</span><span class="n">dt</span>
    <span class="k">end</span>

    <span class="n">sc</span><span class="o">=</span><span class="n">sqrt</span><span class="x">(</span><span class="n">vx</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">^</span><span class="mi">4</span><span class="x">)</span><span class="o">/</span><span class="n">sqrt</span><span class="x">(</span><span class="n">vx</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span>
    <span class="n">vx</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">vx</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">-</span><span class="n">R</span><span class="o">*</span><span class="n">vx</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">*</span><span class="n">sc</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="n">dt</span><span class="o">-</span><span class="n">R</span><span class="o">*</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">*</span><span class="n">sc</span><span class="o">*</span><span class="n">dt</span>

    <span class="n">E</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">g</span><span class="o">*</span><span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">+.</span><span class="mi">5</span><span class="o">*</span><span class="x">(</span><span class="n">vx</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">x</span><span class="x">,</span><span class="n">y</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_31_0.png" alt="Air Resistance" />
    
    
        <p class="image-caption">Path of projectile in the presence of air resistance.</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">yexact</span><span class="o">=-</span><span class="n">g</span><span class="o">/</span><span class="mf">2.</span><span class="o">*</span><span class="n">t</span><span class="o">.^</span><span class="mf">2.</span><span class="o">+</span><span class="n">vy0</span><span class="o">.*</span><span class="n">t</span>

<span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">y</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Air Resistence"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">yexact</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Exact No Air"</span><span class="x">)</span>
<span class="n">ylim</span><span class="x">(</span><span class="o">-.</span><span class="mi">5</span><span class="x">,</span><span class="mi">3</span><span class="x">)</span>

<span class="n">xlabel</span><span class="x">(</span><span class="s">"t"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"y"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">()</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Comparing With and Without Air"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_32_0.png" alt="Height with Drag" />
    
    
        <p class="image-caption">Here we compare the height with and without air resistance over time.  The ball doesn't go quite as high and falls a little sooner.</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">vy</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_33_0.png" alt="Y Velocity" />
    
    
        <p class="image-caption">Y Velocity with Drag</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">vx</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_34_0.png" alt="X Velocity" />
    
    
        <p class="image-caption">X Velocity with Drag.  Here we can see that the projectile slows down in the x direction instead of remaining at the at the same speed like in the other cases, since we have added a force in the x-direction.</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">E</span><span class="x">)</span>

<span class="n">xlabel</span><span class="x">(</span><span class="s">"time"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Energy"</span><span class="x">)</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Decaying Energy with Air Resistence"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_35_0.png" alt="Energy Decay" />
    
    
        <p class="image-caption">Energy Decay. The drag takes energy out of the projectile and disperses into heat.  We lose energy from the potential + kinetic energy sum that we can't get back.</p>
    
</div>

<h1 id="terminal-velocity">Terminal Velocity</h1>

<p>Since we already have the piece of code for air resistance written, let’s just run it for a freely falling object to determine terminal velocity.</p>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">tf</span><span class="o">=</span><span class="mi">10</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">t</span><span class="o">=</span><span class="n">collect</span><span class="x">(</span><span class="n">t0</span><span class="x">:</span><span class="n">dt</span><span class="x">:</span><span class="n">tf</span><span class="x">)</span> <span class="c"># creates an array that holds each time point</span>
<span class="n">nt</span><span class="o">=</span><span class="n">length</span><span class="x">(</span><span class="n">t</span><span class="x">)</span> <span class="c">#the number of time steps we will have</span>

<span class="c">#initializing empty vectors that will hold position and velocity at each time step</span>
<span class="n">y</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">t</span><span class="x">)</span>
<span class="n">vy</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">t</span><span class="x">)</span>
<span class="n">E</span><span class="o">=</span><span class="n">zeros</span><span class="x">(</span><span class="n">t</span><span class="x">)</span>

<span class="n">y</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">vy</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">=</span><span class="mi">0</span>

<span class="n">E</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">=.</span><span class="mi">5</span><span class="o">*</span><span class="n">vy0</span><span class="o">^</span><span class="mi">2</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="k">for</span> <span class="n">ii</span> <span class="k">in</span> <span class="mi">2</span><span class="x">:</span><span class="n">nt</span>
    <span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">+</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">*</span><span class="n">dt</span>

    <span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="n">dt</span><span class="o">-</span><span class="n">R</span><span class="o">*</span><span class="n">sign</span><span class="x">(</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">])</span><span class="o">*</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">dt</span>

    <span class="n">E</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">=</span><span class="n">g</span><span class="o">*</span><span class="n">y</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">+.</span><span class="mi">5</span><span class="o">*</span><span class="n">vy</span><span class="x">[</span><span class="n">ii</span><span class="x">]</span><span class="o">^</span><span class="mi">2</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">vy</span><span class="x">,</span><span class="n">label</span><span class="o">=</span><span class="s">"Velocity"</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">vy</span><span class="x">[</span><span class="k">end</span><span class="x">]</span><span class="o">*</span><span class="n">ones</span><span class="x">(</span><span class="n">t</span><span class="x">),</span><span class="n">label</span><span class="o">=</span><span class="n">round</span><span class="x">(</span><span class="n">vy</span><span class="x">[</span><span class="k">end</span><span class="x">],</span><span class="mi">2</span><span class="x">))</span>

<span class="n">xlabel</span><span class="x">(</span><span class="s">"time"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"y velocity"</span><span class="x">)</span>
<span class="n">legend</span><span class="x">()</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Approaching terminal velocity"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_40_0.png" alt="Y Velocity" />
    
    
        <p class="image-caption">A freely falling ball approaching terminal velocity. After 10 time, it reaches -31.19 dist/time with little acceleration.</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">y</span><span class="x">)</span>
<span class="n">xlabel</span><span class="x">(</span><span class="s">"time"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Position"</span><span class="x">)</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Particle Falling in Air Resistence"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_41_0.png" alt="Particle with Drag" />
    
    
        <p class="image-caption">In the beginning, the particles path looks like a parabola, but as it reaches high speed, the path starts to better mimic a straight line.</p>
    
</div>

<div class="language-julia highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">t</span><span class="x">,</span><span class="n">E</span><span class="x">)</span>
<span class="n">xlabel</span><span class="x">(</span><span class="s">"time"</span><span class="x">)</span>
<span class="n">ylabel</span><span class="x">(</span><span class="s">"Energy"</span><span class="x">)</span>
<span class="n">title</span><span class="x">(</span><span class="s">"Energy of Falling Particle"</span><span class="x">)</span>
</code></pre>
</div>

<!-- _includes/image.html -->
<div class="image-wrapper">
    
        <img src="http://localhost:4000/M4/Images/Projectile/output_42_0.png" alt="Energy Loss from Drag" />
    
    
        <p class="image-caption">As this projectile hits no surface, it can constantly convert gravitational potential to kinetic energy to heat, with nothing stopping it.  Thus it ends up losing energy at a linear rate in the steady state.</p>
    
</div>

<h2 id="the-termination">The Termination</h2>

<p>Now that we have see terminal velocity, I will terminate this post.  See you next time :)</p>

  </article>

</div>

      </div>
    </div>

    <div class="comment">
<!-- Add Disqus comments. -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'M4julia'; // required: replace example with your forum shortname
  var disqus_identifier = "/Projectile-Motion.html";

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>

    <footer class="site-footer">
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>


  <div class="wrapper">

    <h2 class="footer-heading">Metals, Magnets, and Miscellaneous Materials</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Metals, Magnets, and Miscellaneous Materials</li>
          <li><a href="mailto:chrissie.c.l@gmail.com">chrissie.c.l@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/albi3ro">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">albi3ro</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/PyrochloreLee">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">PyrochloreLee</span>
            </a>
          </li>
          
          <li>
              <div class="fb-share-button"
               data-href="/M4/Projectile-Motion.html" data-layout="button_count"></div>

          </li>
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Blog Introduction to Computational Condensed Matter Physics</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-70984222-1', 'auto');
  ga('send', 'pageview');

</script>
