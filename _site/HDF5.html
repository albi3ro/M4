<!DOCTYPE html>
<html>


  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>HDF5 in Julia</title>
    <!-- <meta name="description" content="Blog Introduction to Computational Condensed Matter Physics"> -->
    <link rel="stylesheet" href="/M4/css/main.css">
    <link rel="canonical" href="http://localhost:4000/M4/HDF5.html">
    <meta name="google-site-verification" content="FLWeXTRDBUYGSJXcdiUyqbwExBElCj76l3EdhtLL-wI" />
          <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [ ['$','$'], ['\(', '\)'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true,
    }
  });
</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


    <meta property="og:title" content="HDF5 in Julia" />
    <meta property="og:image" content="" />
    <meta property="twitter:card" content="summary" />
    <meta property="twitter:site" content="@PyrochloreLee" />
    <meta property="twitter:title" content="HDF5 in Julia" />
    <meta property="twitter:image" content="" />
    <meta property="twitter:description" content="" />

    <link rel="apple-touch-icon" sizes="180x180" href="/M4/Images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/M4/Images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/M4/Images/favicons/favicon-16x16.png">
    <link rel="manifest" href="/M4/Images/favicons/manifest.json">
    <link rel="mask-icon" href="/M4/Images/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="theme-color" content="#000000">

</head>


  <body>


    <header class="site-header">

  <div>

    <a class="site-title" href="/M4/">Metals, Magnets, and Miscellaneous Materials</a>

    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top" style="float: right">
    <input type="hidden" name="cmd" value="_donations">
    <input type="hidden" name="business" value="chrissie.c.l@gmail.com">
    <input type="hidden" name="lc" value="US">
    <input type="hidden" name="item_name" value="M4">
    <input type="hidden" name="no_note" value="0">
    <input type="hidden" name="currency_code" value="USD">
    <input type="hidden" name="bn" value="PP-DonationsBF:btn_donate_SM.gif:NonHostedGuest">
    <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
    <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
    </form>



  </div>

</header>




    <div class="page-content">
        <div class="downloadzp"><a href="https://github.com/albi3ro/M4/archive/master.zip" class="sidebar">Zip!</a></div>

        <div class="clonelink"><a href="https://github.com/albi3ro/M4.git" class="sidebar">Clone!</a></div>

        <div class="pdfslink"><a href="/M4/pdfs" class="sidebar">PDFs</a></div>

        <div class="juliadocs"><a href="https://docs.julialang.org/" class="sidebar">Docs</a></div>

        <div class="juliahelp"><a href="/M4/jupyterjulia" class="sidebar">Interact</a></div>

        <div class="about"><a href="/M4/about" class="sidebar">About</a></div>

      <div class="wrapper">
        <div class="post">
<meta name="description" content="" />
<meta name="keywords" content="" />
<meta name="author" content="Christina C. Lee" />

  <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

  <header class="post-header">
    <h1 class="post-title" itemprop="name">HDF5 in Julia</h1>
    <p class="post-meta">Author: Christina C. Lee &nbsp;&nbsp;&nbsp;&nbsp;
      Category: <a href="/M4/categories#Programming">
        Programming</a> &nbsp;  &nbsp; &nbsp; &nbsp;
        Tags:
      
        &nbsp;  &nbsp; &nbsp; &nbsp;
      Series: <a href="/M4/series#"></a>
      </p>
  </header>

  <article class="post-content">

    <p>So, last summer, my program was producing three dimensional data, and I needed a way to export and save that data from my C++ program.  Simple ASCII files, my default method, no longer covered my needs.  Of course, I wasn’t the first person to encounter this problem, so I discovered the HDF5 standard.</p>

<p>Instead of storing data in a human readable format like ASCII, the Hierarchical Data Format, HDF, stores data in binary format.  This preserves the shape of the data in the computer and keeps it at its minimum size.  WOHOO!!</p>

<p>Sadly, the syntax for HDF5 in C++ and Fortran is just as bad as FFTW or OpenBLAS.  But happily, just like FFTW and OpenBLAS, HDF5 has wonderful syntax in Julia, Python, and julia, among others.</p>

<p>So how does it work?</p>

<p>We don’t just print a single variable.  Each HDF5 file is like its own file system.  In my home directory, I have my documents folder, my programming folder, my pictures, configuration files,… and inside each folder I can have subfolders or files.</p>

<p>The same is true for an HDF5 file.  We have the root, and then we have groups and subgroups.  A group is like a folder.  Then we can have datasets. Datasets are objects that hold data (files).</p>

<h2 id="installing-the-package">Installing the Package</h2>

<p>While running <code class="highlighter-rouge">Pkg.add("HDF5");</code> should hopefully add the HDF5 library, additional steps may be required.  I remember having a horrible time with the HDF installation when using C++ a year ago.  If at all possible, just use a package manager, and do not try and install it from source! See the HDF5.jl or HDFGroup pages for details.</p>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">using</span> <span class="n">HDF5</span><span class="x">;</span></code></pre></figure>

<h1 id="hello-world">Hello World</h1>
<p>Firstly, lets open a file and then write some data to it.</p>

<p>We can open a file in three ways:</p>

<table>
  <thead>
    <tr>
      <th>Symbol</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>“w”</td>
      <td>Write.  Will overwrite anything already there.</td>
    </tr>
    <tr>
      <td>“r”</td>
      <td>Ready-only.</td>
    </tr>
    <tr>
      <td>“r+”</td>
      <td>Read-write. Preserving existing contents.</td>
    </tr>
  </tbody>
</table>

<p>If we open with this syntax, we have to always remember to close it with <code class="highlighter-rouge">close()</code></p>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">fid</span><span class="o">=</span><span class="n">h5open</span><span class="x">(</span><span class="s">"test.h5"</span><span class="x">,</span><span class="s">"w"</span><span class="x">)</span>

<span class="n">fid</span><span class="x">[</span><span class="s">"string"</span><span class="x">]</span><span class="o">=</span><span class="s">"Hello World"</span>

<span class="n">close</span><span class="x">(</span><span class="n">fid</span><span class="x">)</span></code></pre></figure>

<h3 id="navigating-a-file">Navigating a File</h3>

<p>Now lets see if we were successful by reading.  Instead of reading the dataset, we are going to checkout the structure of the file first.</p>

<p><code class="highlighter-rouge">names(fid)</code> tells us what is inside the location <code class="highlighter-rouge">fid</code>.</p>

<p><code class="highlighter-rouge">dump(fid)</code> is much more in depth, exploring everything below <code class="highlighter-rouge">fid</code>.  If we had a bunch of subdirectories, it would go down each one to see what was there.</p>

<p>Both these functions help you find your way around a file.</p>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">fid</span><span class="o">=</span><span class="n">h5open</span><span class="x">(</span><span class="s">"test.h5"</span><span class="x">,</span><span class="s">"r"</span><span class="x">)</span>

<span class="n">println</span><span class="x">(</span><span class="s">"names </span><span class="se">\n</span><span class="s">"</span><span class="x">,</span><span class="n">names</span><span class="x">(</span><span class="n">fid</span><span class="x">))</span>

<span class="n">println</span><span class="x">(</span><span class="s">"</span><span class="se">\n</span><span class="s"> dump"</span><span class="x">)</span>
<span class="n">println</span><span class="x">(</span><span class="n">dump</span><span class="x">(</span><span class="n">fid</span><span class="x">))</span>

<span class="n">close</span><span class="x">(</span><span class="n">fid</span><span class="x">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>names
Union{ASCIIString,UTF8String}["string"]

 dump
HDF5.HDF5File len 1
  string: HDF5Dataset () : Hello World
nothing
</code></pre>
</div>

<h3 id="reading-data">Reading Data</h3>
<p>Now when we are reading data, we need to know the difference between dataset and the data the dataset contains.</p>

<p>Look at the below example</p>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">fid</span><span class="o">=</span><span class="n">h5open</span><span class="x">(</span><span class="s">"test.h5"</span><span class="x">,</span><span class="s">"r"</span><span class="x">)</span>

<span class="n">dset</span><span class="o">=</span><span class="n">fid</span><span class="x">[</span><span class="s">"string"</span><span class="x">]</span>
<span class="n">println</span><span class="x">(</span><span class="s">"the dataset: </span><span class="se">\t</span><span class="s">"</span><span class="x">,</span> <span class="nb">typeof</span><span class="x">(</span><span class="n">dset</span><span class="x">))</span>

<span class="n">data</span><span class="o">=</span><span class="n">read</span><span class="x">(</span><span class="n">dset</span><span class="x">)</span>
<span class="n">println</span><span class="x">(</span><span class="s">"the string: </span><span class="se">\t</span><span class="s">"</span><span class="x">,</span> <span class="nb">typeof</span><span class="x">(</span><span class="n">data</span><span class="x">),</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="x">,</span><span class="n">data</span><span class="x">)</span>

<span class="n">data2</span><span class="o">=</span><span class="n">read</span><span class="x">(</span><span class="n">fid</span><span class="x">,</span><span class="s">"string"</span><span class="x">)</span>
<span class="n">println</span><span class="x">(</span><span class="s">"read another way: </span><span class="se">\t</span><span class="s">"</span><span class="x">,</span> <span class="nb">typeof</span><span class="x">(</span><span class="n">data2</span><span class="x">),</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="x">,</span><span class="n">data2</span><span class="x">)</span>

<span class="n">close</span><span class="x">(</span><span class="n">fid</span><span class="x">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>the dataset: 	HDF5.HDF5Dataset
the string: 	ASCIIString	Hello World
read another way: 	ASCIIString	Hello World
</code></pre>
</div>

<p>A dataset is like the filename “fairytale.txt”, so we then need to read the file to get “Once upon a time …”.</p>

<h3 id="groups">Groups</h3>
<p>I’ve talked about groups, but we haven’t done anything with them yet. Let’s make some!</p>

<p>Here we use <code class="highlighter-rouge">g_create</code> to create two groups, one inside the other.  For the subgroup, it’s parent is <code class="highlighter-rouge">g</code>, so we have to create it at location <code class="highlighter-rouge">g</code>.  Just like in a filesystem, it’s name/ path is nested within its parent’s path.</p>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">fid</span><span class="o">=</span><span class="n">h5open</span><span class="x">(</span><span class="s">"test.h5"</span><span class="x">,</span><span class="s">"w"</span><span class="x">)</span>

<span class="n">g</span><span class="o">=</span><span class="n">g_create</span><span class="x">(</span><span class="n">fid</span><span class="x">,</span><span class="s">"mygroup"</span><span class="x">);</span>
<span class="n">h</span><span class="o">=</span><span class="n">g_create</span><span class="x">(</span><span class="n">g</span><span class="x">,</span><span class="s">"mysubgroup"</span><span class="x">);</span>

<span class="n">println</span><span class="x">(</span><span class="n">dump</span><span class="x">(</span><span class="n">fid</span><span class="x">))</span>

<span class="n">println</span><span class="x">(</span><span class="s">"</span><span class="se">\n</span><span class="s"> path of h:  "</span><span class="x">,</span><span class="n">name</span><span class="x">(</span><span class="n">h</span><span class="x">))</span>

<span class="n">close</span><span class="x">(</span><span class="n">fid</span><span class="x">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>HDF5.HDF5File len 1
  mygroup: HDF5.HDF5Group len 1
    mysubgroup: HDF5.HDF5Group len 0
nothing

 path of h:  /mygroup/mysubgroup
</code></pre>
</div>

<h3 id="attributes">Attributes</h3>

<p>Say in a file I want to include the information that I ran the simulation with 100 sites, at 1 Kelvin, for 100,000 timesteps.  Instead of creating new datasets for each of these individual numbers, I can create attributes and tie them to either a group or a dataset.</p>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">fid</span><span class="o">=</span><span class="n">h5open</span><span class="x">(</span><span class="s">"test.h5"</span><span class="x">,</span><span class="s">"w"</span><span class="x">)</span>

<span class="n">fid</span><span class="x">[</span><span class="s">"data"</span><span class="x">]</span><span class="o">=</span><span class="n">randn</span><span class="x">(</span><span class="mi">3</span><span class="x">,</span><span class="mi">3</span><span class="x">);</span>

<span class="n">attrs</span><span class="x">(</span><span class="n">fid</span><span class="x">[</span><span class="s">"data"</span><span class="x">])[</span><span class="s">"Temp"</span><span class="x">]</span><span class="o">=</span><span class="s">"1"</span><span class="x">;</span>
<span class="n">attrs</span><span class="x">(</span><span class="n">fid</span><span class="x">[</span><span class="s">"data"</span><span class="x">])[</span><span class="s">"N Sites"</span><span class="x">]</span><span class="o">=</span><span class="s">"100"</span><span class="x">;</span>

<span class="n">close</span><span class="x">(</span><span class="n">fid</span><span class="x">)</span>

<span class="n">fid</span><span class="o">=</span><span class="n">h5open</span><span class="x">(</span><span class="s">"test.h5"</span><span class="x">,</span><span class="s">"r"</span><span class="x">)</span>

<span class="n">dset</span><span class="o">=</span><span class="n">fid</span><span class="x">[</span><span class="s">"data"</span><span class="x">];</span>

<span class="n">println</span><span class="x">(</span><span class="s">"typeof attrs: </span><span class="se">\t</span><span class="s">"</span><span class="x">,</span> <span class="nb">typeof</span><span class="x">(</span><span class="n">attrs</span><span class="x">(</span><span class="n">dset</span><span class="x">)))</span>
<span class="n">println</span><span class="x">(</span><span class="s">"Temp: </span><span class="se">\t</span><span class="s">"</span><span class="x">,</span><span class="n">read</span><span class="x">(</span> <span class="n">attrs</span><span class="x">(</span><span class="n">dset</span><span class="x">),</span><span class="s">"Temp"</span>  <span class="x">))</span>
<span class="n">println</span><span class="x">(</span><span class="s">"N Sites: </span><span class="se">\t</span><span class="s">"</span><span class="x">,</span><span class="n">read</span><span class="x">(</span>  <span class="n">attrs</span><span class="x">(</span><span class="n">dset</span><span class="x">),</span><span class="s">"N Sites"</span>  <span class="x">))</span>

<span class="n">close</span><span class="x">(</span><span class="n">fid</span><span class="x">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>typeof attrs: 	HDF5.HDF5Attributes
Temp: 	1
N Sites: 	100
</code></pre>
</div>

<h3 id="final-tips">Final Tips</h3>

<p>Before diving in to learn how to use this, think about whether you need it or not.  How large and complex is your data?  Is it worth the time to learn?  While the syntax might be relatively simple in Julia, ASCII files are still much easier to deal with.</p>

<p>If you are going to play around or use this format, I recommend getting an HDF viewer, like <a href="https://www.hdfgroup.org/products/java/release/download.html">HDFViewer</a>. While you can have much more control via code, sometimes it is just that much simpler to check everything is working with a GUI.</p>

<p>For more information, checkout the Package page at <a href="https://github.com/JuliaLang/HDF5.jl">HDF5.jl</a> or the HDFGroup page at <a href="https://www.hdfgroup.org/">HDFGroup</a></p>

<p>I’ve shown some of the basic functionality in simple test cases.  If you want more control, you might just have to work a bit for it.</p>

  </article>

</div>

      </div>
    </div>

    <div class="comment">
<!-- Add Disqus comments. -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'M4julia'; // required: replace example with your forum shortname
  var disqus_identifier = "/HDF5.html";

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>

    <footer class="site-footer">
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>


  <div class="wrapper">

    <h2 class="footer-heading">Metals, Magnets, and Miscellaneous Materials</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Metals, Magnets, and Miscellaneous Materials</li>
          <li><a href="mailto:chrissie.c.l@gmail.com">chrissie.c.l@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/albi3ro">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">albi3ro</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/PyrochloreLee">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">PyrochloreLee</span>
            </a>
          </li>
          
          <li>
              <div class="fb-share-button"
               data-href="/M4/HDF5.html" data-layout="button_count"></div>

          </li>
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Blog Introduction to Computational Condensed Matter Physics</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-70984222-1', 'auto');
  ga('send', 'pageview');

</script>
